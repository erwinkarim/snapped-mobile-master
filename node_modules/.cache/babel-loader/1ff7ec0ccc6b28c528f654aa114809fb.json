{"remainingRequest":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/thread-loader/dist/cjs.js!/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/babel-loader/lib/index.js!/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/src/store/modules/teacherMarking.js","dependencies":[{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/src/store/modules/teacherMarking.js","mtime":1680008048382},{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/babel.config.js","mtime":1679379067182},{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/cache-loader/dist/cjs.js","mtime":1680070113546},{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/thread-loader/dist/cjs.js","mtime":1680070298752},{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/babel-loader/lib/index.js","mtime":1680059914906}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IFN1Ym1pc3Npb25SZXBvc2l0b3J5IGZyb20gIkAvcmVwb3NpdG9yaWVzL1N1Ym1pc3Npb25SZXBvc2l0b3J5IjsKaW1wb3J0IHsgZ2V0IH0gZnJvbSAidi1jYWxlbmRhci9zcmMvdXRpbHMvXyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiQC9yb3V0ZXIiOwppbXBvcnQgeyBmYWJyaWMgfSBmcm9tICJmYWJyaWMiOwppbXBvcnQgc3RpY2tlcnMgZnJvbSAiQC9jb21wb25lbnRzL1N0aWNrZXJzL1N0aWNrZXJzIjsKaW1wb3J0IE1hcmtzUmVwb3NpdG9yeSBmcm9tICJAL3JlcG9zaXRvcmllcy90ZWFjaGVycy9NYXJrc1JlcG9zaXRvcnkiOwppbXBvcnQgJ2ZhYnJpYy1oaXN0b3J5JzsKaW1wb3J0IGdldHRlcnMgZnJvbSAiQC9zdG9yZS9nZXR0ZXJzIjsKY29uc3QgZ2V0RGVmYXVsdFN0YXRlID0gKCkgPT4gewogIHJldHVybiB7CiAgICBzdGF0ZXM6IHsKICAgICAgaXNMb2FkaW5nOiB0cnVlLAogICAgICBpc01haW46IHRydWUsCiAgICAgIGlzUHJldmlld2luZzogZmFsc2UsCiAgICAgIGlzUHJlcGFyaW5nQ2FudmFzOiBmYWxzZSwKICAgICAgaXNNYXJraW5nOiBmYWxzZSwKICAgICAgaXNTZWxlY3RpbmdTdGlja2VyOiBmYWxzZSwKICAgICAgaXNTZWxlY3RpbmdPYmplY3Q6IGZhbHNlLAogICAgICBpc1pvb21pbmdDYW52YXM6IGZhbHNlLAogICAgICBpc1Bhbm5pbmdDYW52YXM6IGZhbHNlLAogICAgICBpc01vdmluZ09iamVjdDogZmFsc2UsCiAgICAgIGlzTW9kaWZ5aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgaXNEcmF3aW5nOiBmYWxzZSwKICAgICAgaXNXcml0aW5nRmVlZGJhY2s6IGZhbHNlLAogICAgICBpc0NoZWNraW5nU3VibWlzc2lvbjogZmFsc2UsCiAgICAgIGlzU3VibWl0dGluZzogZmFsc2UsCiAgICAgIGlzU2hvd2luZ01vZGFsOiBmYWxzZSwKICAgICAgaXNTYXZpbmdFZGl0ZWRTbmFwcGVkQW5zd2VyOiBmYWxzZQogICAgfSwKICAgIC8vIEFzc2lnbm1lbnQgRGV0YWlscwogICAgYXNzaWdubWVudERldGFpbHM6IHsKICAgICAgc3VibWlzc2lvbklEOiBudWxsLAogICAgICBzdHVkZW50SUQ6IG51bGwsCiAgICAgIHN0dWRlbnROYW1lOiBudWxsLAogICAgICBhc3NpZ25tZW50SUQ6IG51bGwsCiAgICAgIGFzc2lnbm1lbnRUaXRsZTogbnVsbCwKICAgICAgc25hcHBlZEFuc3dlclBhdGhzOiBudWxsLAogICAgICB3cml0dGVuQW5zd2VyOiBudWxsLAogICAgICBjcmVhdGVkQXQ6IG51bGwsCiAgICAgIHVwZGF0ZWRBdDogbnVsbCwKICAgICAgc3VibWl0dGVkVGltZTogbnVsbCwKICAgICAgc3VibWl0dGVkRGF0ZTogbnVsbCwKICAgICAgbWFya3NJRDogbnVsbCwKICAgICAgbWFya3M6IG51bGwsCiAgICAgIG1hcmtlZFNuYXBwZWRBbnN3ZXJQYXRoczogbnVsbCwKICAgICAgYW5zd2VyX3RhZzogbnVsbAogICAgfSwKICAgIC8vIEltYWdlIGJlaW5nIG1hcmtlZCAodGVtcG9yYXJ5KQogICAgbm93TWFya2luZzogewogICAgICBpbWFnZTogewogICAgICAgIGluZGV4OiBudWxsLAogICAgICAgIHBhdGg6IG51bGwsCiAgICAgICAgZGltZW5zaW9uczogewogICAgICAgICAgaGVpZ2h0OiBudWxsLAogICAgICAgICAgd2lkdGg6IG51bGwKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNlbGVjdGVkT2JqZWN0OiBudWxsLAogICAgICBzdGlja2VyOiBudWxsLAogICAgICB0ZXh0Qm94OiBmYWxzZSwKICAgICAgY2FudmFzOiB7CiAgICAgICAgbWFpbjogewogICAgICAgICAgaW5kZXg6IG51bGwsCiAgICAgICAgICBkaW1lbnNpb25zOiB7CiAgICAgICAgICAgIGhlaWdodDogbnVsbCwKICAgICAgICAgICAgd2lkdGg6IG51bGwKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG1hcmtpbmdzOiB7CiAgICAgICAgICBpbmRleDogbnVsbCwKICAgICAgICAgIGRpbWVuc2lvbnM6IHsKICAgICAgICAgICAgaGVpZ2h0OiBudWxsLAogICAgICAgICAgICB3aWR0aDogbnVsbAogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgdHJhc2hPYmplY3Q6IG51bGwsCiAgICAgIG92ZXJsYXlTY3JlZW46IG51bGwsCiAgICAgIC8vIG92ZXJsYXkgc2NyZWVuIG9iamVjdAogICAgICBpc092ZXJsYWlkOiBmYWxzZSAvLyBpcyBjYW52YXMgb3ZlcmxhaWQKICAgIH0sCgogICAgLy8gRHJhd2luZyBNb2RlIHN0YXRlcwogICAgbm93RHJhd2luZzogewogICAgICBkcmF3aW5nOiB0cnVlLAogICAgICBlcmFzaW5nOiBmYWxzZQogICAgfSwKICAgIC8vIE1vZGFsIGJlaW5nIGRpc3BsYXllZAogICAgbm93U2hvd2luZ01vZGFsOiBudWxsLAogICAgLy8gQXZhaWxhYmxlIHN0aWNrZXJzCiAgICBzdGlja2VyQ29sbGVjdGlvbjogWyd0aWNrLXN0aWNrZXInLCAnY29uZnVzZWQtcGVyc29uLXN0aWNrZXInLCAndG9wLXN0aWNrZXInLCAnbGV0cy1nby1zdGlja2VyJywgJ2ZhbHNlLXN0aWNrZXInLCAncXVlc3Rpb24tbWFyay1zdGlja2VyJ10sCiAgICAvLyBNYXJrZWQgaW1hZ2VzCiAgICBtYXJraW5nOiBbXSwKICAgIHN1Ym1pc3Npb246IHsKICAgICAgdHlwZTogJycsCiAgICAgIHNuYXBwZWRBbnN3ZXJzOiBbXSwKICAgICAgZmVlZGJhY2s6ICcnLAogICAgICBtYXJrczogbnVsbAogICAgfSwKICAgIGVycm9yTWVzc2FnZXM6IG51bGwKICB9Owp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogKCkgPT4gZ2V0RGVmYXVsdFN0YXRlKCksCiAgbXV0YXRpb25zOiB7CiAgICBzZXRBc3NpZ25tZW50RGV0YWlscyhzdGF0ZSwgZGF0YSkgewogICAgICBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5zdWJtaXNzaW9uSUQgPSBkYXRhLnN1Ym1pc3Npb25faWQ7CiAgICAgIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLnN0dWRlbnRJRCA9IGRhdGEuc3R1ZGVudF9pZDsKICAgICAgc3RhdGUuYXNzaWdubWVudERldGFpbHMuc3R1ZGVudE5hbWUgPSBkYXRhLnN0dWRlbnRfbmFtZTsKICAgICAgc3RhdGUuYXNzaWdubWVudERldGFpbHMuYXNzaWdubWVudElEID0gZGF0YS5hc3NpZ25tZW50X2lkOwogICAgICBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5hc3NpZ25tZW50VGl0bGUgPSBkYXRhLmFzc2lnbm1lbnRfdGl0bGU7CiAgICAgIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLndyaXR0ZW5BbnN3ZXIgPSBkYXRhLndyaXR0ZW5fYW5zd2VyOwogICAgICBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5jcmVhdGVkQXQgPSBkYXRhLmNyZWF0ZWRfYXQ7CiAgICAgIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLnVwZGF0ZWRBdCA9IGRhdGEudXBkYXRlZF9hdDsKICAgICAgc3RhdGUuYXNzaWdubWVudERldGFpbHMuc3VibWl0dGVkVGltZSA9IGRhdGEuc3VibWlzc2lvbl90aW1lOwogICAgICBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5zdWJtaXR0ZWREYXRlID0gZGF0YS5zdWJtaXNzaW9uX2RhdGU7CiAgICAgIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLm1hcmtzSUQgPSBkYXRhLm1hcmtzX2lkOwogICAgICBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5tYXJrcyA9IGRhdGEubWFya3M7CiAgICAgIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLmlzRmlyc3RTdWJtaXNzaW9uID0gZGF0YS5pc19maXJzdDsKICAgICAgc3RhdGUuYXNzaWdubWVudERldGFpbHMuYW5zd2VyX3RhZyA9IGRhdGEuYW5zd2VyX3RhZzsKICAgICAgaWYgKGRhdGEuc25hcF9hbnN3ZXIpIHsKICAgICAgICBzdGF0ZS5zdWJtaXNzaW9uLnR5cGUgPSAnc25hcHBlZCc7CiAgICAgICAgc3RhdGUuYXNzaWdubWVudERldGFpbHMuc25hcHBlZEFuc3dlclBhdGhzID0gc3RhdGUubWFya2luZyA9IGRhdGEuc25hcF9hbnN3ZXJfdXJsLnNwbGl0KCcsJyk7CiAgICAgIH0KICAgICAgaWYgKGRhdGEud3JpdHRlbl9hbnN3ZXIpIHsKICAgICAgICBzdGF0ZS5zdWJtaXNzaW9uLnR5cGUgPSAnd3JpdHRlbic7CiAgICAgIH0KICAgICAgaWYgKGRhdGEubWFya2luZ19waWN0dXJlX3VybCkgewogICAgICAgIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLm1hcmtlZFNuYXBwZWRBbnN3ZXJQYXRocyA9IGRhdGEubWFya2luZ19waWN0dXJlX3VybC5zcGxpdCgnLCcpOwogICAgICB9CiAgICB9LAogICAgbG9hZENhbnZhcyhzdGF0ZSkgewogICAgICAvLyBJbml0aWFsaXNlIGNhbnZhcyB3aXRoIHBsYWNlaG9sZGVyIGRpbWVuc2lvbnMuIFRvIGJlIHJlc2l6ZWQgb25jZSBsb2FkZWQgaW1hZ2UKICAgICAgc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleCA9IG5ldyBmYWJyaWMuQ2FudmFzKCdjYW52YXMnLCB7CiAgICAgICAgd2lkdGg6IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uZGltZW5zaW9ucy53aWR0aCwKICAgICAgICBoZWlnaHQ6IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uZGltZW5zaW9ucy5oZWlnaHQKICAgICAgfSk7CiAgICB9LAogICAgZGlzcG9zZUNhbnZhcyhzdGF0ZSkgewogICAgICBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4LmRpc3Bvc2UoKTsKICAgIH0sCiAgICB0b2dnbGVQcmV2aWV3TW9kZShzdGF0ZSkgewogICAgICBzdGF0ZS5zdGF0ZXMgPSB7CiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBpc01haW46ICFzdGF0ZS5zdGF0ZXMuaXNNYWluLAogICAgICAgIGlzUHJldmlld2luZzogIXN0YXRlLnN0YXRlcy5pc1ByZXZpZXdpbmcsCiAgICAgICAgaXNQcmVwYXJpbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzTWFya2luZzogZmFsc2UsCiAgICAgICAgaXNTZWxlY3RpbmdTdGlja2VyOiBmYWxzZSwKICAgICAgICBpc1NlbGVjdGluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNab29taW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc1Bhbm5pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzRHJhd2luZzogZmFsc2UsCiAgICAgICAgaXNNb3ZpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzTW9kaWZ5aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1dyaXRpbmdGZWVkYmFjazogZmFsc2UsCiAgICAgICAgaXNDaGVja2luZ1N1Ym1pc3Npb246IGZhbHNlLAogICAgICAgIGlzU3VibWl0dGluZzogZmFsc2UsCiAgICAgICAgaXNTaG93aW5nTW9kYWw6IGZhbHNlLAogICAgICAgIGlzU2F2aW5nRWRpdGVkU25hcHBlZEFuc3dlcjogZmFsc2UKICAgICAgfTsKICAgIH0sCiAgICBzZXRNYWluTW9kZShzdGF0ZSkgewogICAgICBzdGF0ZS5zdGF0ZXMgPSB7CiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBpc01haW46IHRydWUsCiAgICAgICAgaXNQcmV2aWV3aW5nOiBmYWxzZSwKICAgICAgICBpc1ByZXBhcmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNNYXJraW5nOiBmYWxzZSwKICAgICAgICBpc1NlbGVjdGluZ1N0aWNrZXI6IGZhbHNlLAogICAgICAgIGlzU2VsZWN0aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1pvb21pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzUGFubmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNEcmF3aW5nOiBmYWxzZSwKICAgICAgICBpc01vdmluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNNb2RpZnlpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzV3JpdGluZ0ZlZWRiYWNrOiBmYWxzZSwKICAgICAgICBpc0NoZWNraW5nU3VibWlzc2lvbjogZmFsc2UsCiAgICAgICAgaXNTdWJtaXR0aW5nOiBmYWxzZSwKICAgICAgICBpc1Nob3dpbmdNb2RhbDogZmFsc2UsCiAgICAgICAgaXNTYXZpbmdFZGl0ZWRTbmFwcGVkQW5zd2VyOiBmYWxzZQogICAgICB9OwogICAgfSwKICAgIHNldFdyaXRpbmdGZWVkYmFja01vZGUoc3RhdGUpIHsKICAgICAgc3RhdGUuc3RhdGVzID0gewogICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgaXNNYWluOiBmYWxzZSwKICAgICAgICBpc1ByZXZpZXdpbmc6IGZhbHNlLAogICAgICAgIGlzUHJlcGFyaW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc01hcmtpbmc6IGZhbHNlLAogICAgICAgIGlzU2VsZWN0aW5nU3RpY2tlcjogZmFsc2UsCiAgICAgICAgaXNTZWxlY3RpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzWm9vbWluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNQYW5uaW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc0RyYXdpbmc6IGZhbHNlLAogICAgICAgIGlzTW92aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc01vZGlmeWluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNXcml0aW5nRmVlZGJhY2s6IHRydWUsCiAgICAgICAgaXNDaGVja2luZ1N1Ym1pc3Npb246IGZhbHNlLAogICAgICAgIGlzU3VibWl0dGluZzogZmFsc2UsCiAgICAgICAgaXNTaG93aW5nTW9kYWw6IGZhbHNlLAogICAgICAgIGlzU2F2aW5nRWRpdGVkU25hcHBlZEFuc3dlcjogZmFsc2UKICAgICAgfTsKICAgIH0sCiAgICBleGl0V3JpdGluZ0ZlZWRiYWNrTW9kZShzdGF0ZSkgewogICAgICBzdGF0ZS5zdGF0ZXMgPSB7CiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBpc01haW46IGZhbHNlLAogICAgICAgIGlzUHJldmlld2luZzogdHJ1ZSwKICAgICAgICBpc1ByZXBhcmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNNYXJraW5nOiBmYWxzZSwKICAgICAgICBpc1NlbGVjdGluZ1N0aWNrZXI6IGZhbHNlLAogICAgICAgIGlzU2VsZWN0aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1pvb21pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzUGFubmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNEcmF3aW5nOiBmYWxzZSwKICAgICAgICBpc01vdmluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNNb2RpZnlpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzV3JpdGluZ0ZlZWRiYWNrOiBmYWxzZSwKICAgICAgICBpc0NoZWNraW5nU3VibWlzc2lvbjogZmFsc2UsCiAgICAgICAgaXNTdWJtaXR0aW5nOiBmYWxzZSwKICAgICAgICBpc1Nob3dpbmdNb2RhbDogZmFsc2UsCiAgICAgICAgaXNTYXZpbmdFZGl0ZWRTbmFwcGVkQW5zd2VyOiBmYWxzZQogICAgICB9OwogICAgfSwKICAgIHRvZ2dsZVN0aWNrZXJCYXIoc3RhdGUpIHsKICAgICAgc3RhdGUuc3RhdGVzID0gewogICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgaXNNYWluOiBmYWxzZSwKICAgICAgICBpc1ByZXZpZXdpbmc6IGZhbHNlLAogICAgICAgIGlzUHJlcGFyaW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc01hcmtpbmc6IHRydWUsCiAgICAgICAgaXNTZWxlY3RpbmdTdGlja2VyOiAhc3RhdGUuc3RhdGVzLmlzU2VsZWN0aW5nU3RpY2tlciwKICAgICAgICBpc1NlbGVjdGluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNab29taW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc1Bhbm5pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzRHJhd2luZzogZmFsc2UsCiAgICAgICAgaXNNb3ZpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzTW9kaWZ5aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1dyaXRpbmdGZWVkYmFjazogZmFsc2UsCiAgICAgICAgaXNDaGVja2luZ1N1Ym1pc3Npb246IGZhbHNlLAogICAgICAgIGlzU3VibWl0dGluZzogZmFsc2UsCiAgICAgICAgaXNTaG93aW5nTW9kYWw6IGZhbHNlLAogICAgICAgIGlzU2F2aW5nRWRpdGVkU25hcHBlZEFuc3dlcjogZmFsc2UKICAgICAgfTsKICAgIH0sCiAgICB0b2dnbGVFZGl0aW5nVGV4dGJveE1vZGUoc3RhdGUpIHsKICAgICAgc3RhdGUuc3RhdGVzID0gewogICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgaXNNYWluOiBmYWxzZSwKICAgICAgICBpc1ByZXZpZXdpbmc6IGZhbHNlLAogICAgICAgIGlzUHJlcGFyaW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc01hcmtpbmc6IHRydWUsCiAgICAgICAgaXNTZWxlY3RpbmdTdGlja2VyOiBmYWxzZSwKICAgICAgICBpc1NlbGVjdGluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNab29taW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc1Bhbm5pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzRHJhd2luZzogIXN0YXRlLnN0YXRlcy5pc0RyYXdpbmcsCiAgICAgICAgaXNNb3ZpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzTW9kaWZ5aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1dyaXRpbmdGZWVkYmFjazogZmFsc2UsCiAgICAgICAgaXNDaGVja2luZ1N1Ym1pc3Npb246IGZhbHNlLAogICAgICAgIGlzU3VibWl0dGluZzogZmFsc2UsCiAgICAgICAgaXNTaG93aW5nTW9kYWw6IGZhbHNlLAogICAgICAgIGlzU2F2aW5nRWRpdGVkU25hcHBlZEFuc3dlcjogZmFsc2UKICAgICAgfTsKICAgIH0sCiAgICB0b2dnbGVEcmF3aW5nTW9kZShzdGF0ZSkgewogICAgICBzdGF0ZS5zdGF0ZXMgPSB7CiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBpc01haW46IGZhbHNlLAogICAgICAgIGlzUHJldmlld2luZzogZmFsc2UsCiAgICAgICAgaXNQcmVwYXJpbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzTWFya2luZzogdHJ1ZSwKICAgICAgICBpc1NlbGVjdGluZ1N0aWNrZXI6IGZhbHNlLAogICAgICAgIGlzU2VsZWN0aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1pvb21pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzUGFubmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNEcmF3aW5nOiAhc3RhdGUuc3RhdGVzLmlzRHJhd2luZywKICAgICAgICBpc01vdmluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNNb2RpZnlpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzV3JpdGluZ0ZlZWRiYWNrOiBmYWxzZSwKICAgICAgICBpc0NoZWNraW5nU3VibWlzc2lvbjogZmFsc2UsCiAgICAgICAgaXNTdWJtaXR0aW5nOiBmYWxzZSwKICAgICAgICBpc1Nob3dpbmdNb2RhbDogZmFsc2UsCiAgICAgICAgaXNTYXZpbmdFZGl0ZWRTbmFwcGVkQW5zd2VyOiBmYWxzZQogICAgICB9OwogICAgfSwKICAgIHRvZ2dsZURyYXdpbmdNb2RlU3RhdGVzKHN0YXRlKSB7CiAgICAgIC8vIElmIGlzRHJhd2luZywgdGhlbiBpbml0aWFsaXNlIGRyYXdpbmcgbW9kZSBzdGF0ZXMKICAgICAgaWYgKHN0YXRlLnN0YXRlcy5pc0RyYXdpbmcpIHsKICAgICAgICBzdGF0ZS5ub3dEcmF3aW5nLmRyYXdpbmcgPSAhc3RhdGUubm93RHJhd2luZy5kcmF3aW5nOwogICAgICAgIHN0YXRlLm5vd0RyYXdpbmcuZXJhc2luZyA9ICFzdGF0ZS5ub3dEcmF3aW5nLmVyYXNpbmc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3RhdGUubm93RHJhd2luZy5kcmF3aW5nID0gdHJ1ZTsKICAgICAgICBzdGF0ZS5ub3dEcmF3aW5nLmVyYXNpbmcgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZU1vZGFsTW9kZShzdGF0ZSwgdHlwZSkgewogICAgICBzdGF0ZS5zdGF0ZXMgPSB7CiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBpc01haW46IGZhbHNlLAogICAgICAgIGlzUHJldmlld2luZzogdHJ1ZSwKICAgICAgICBpc1ByZXBhcmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNNYXJraW5nOiBmYWxzZSwKICAgICAgICBpc1NlbGVjdGluZ1N0aWNrZXI6IGZhbHNlLAogICAgICAgIGlzU2VsZWN0aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1pvb21pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzUGFubmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNEcmF3aW5nOiBmYWxzZSwKICAgICAgICBpc01vdmluZ09iamVjdDogIXN0YXRlLnN0YXRlcy5pc01vdmluZ09iamVjdCwKICAgICAgICBpc1dyaXRpbmdGZWVkYmFjazogZmFsc2UsCiAgICAgICAgaXNDaGVja2luZ1N1Ym1pc3Npb246IGZhbHNlLAogICAgICAgIGlzU3VibWl0dGluZzogZmFsc2UsCiAgICAgICAgaXNTaG93aW5nTW9kYWw6ICFzdGF0ZS5zdGF0ZXMuaXNTaG93aW5nTW9kYWwsCiAgICAgICAgaXNTYXZpbmdFZGl0ZWRTbmFwcGVkQW5zd2VyOiBmYWxzZQogICAgICB9OwogICAgICBzdGF0ZS5ub3dTaG93aW5nTW9kYWwgPSB0eXBlOwogICAgfSwKICAgIHNldE1hcmtpbmdNb2RlKHN0YXRlKSB7CiAgICAgIHN0YXRlLnN0YXRlcyA9IHsKICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgICAgIGlzTWFpbjogZmFsc2UsCiAgICAgICAgaXNQcmV2aWV3aW5nOiBmYWxzZSwKICAgICAgICBpc1ByZXBhcmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNNYXJraW5nOiB0cnVlLAogICAgICAgIGlzU2VsZWN0aW5nU3RpY2tlcjogZmFsc2UsCiAgICAgICAgaXNTZWxlY3RpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzWm9vbWluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNQYW5uaW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc0RyYXdpbmc6IGZhbHNlLAogICAgICAgIGlzTW92aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc01vZGlmeWluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNXcml0aW5nRmVlZGJhY2s6IGZhbHNlLAogICAgICAgIGlzQ2hlY2tpbmdTdWJtaXNzaW9uOiBmYWxzZSwKICAgICAgICBpc1N1Ym1pdHRpbmc6IGZhbHNlLAogICAgICAgIGlzU2hvd2luZ01vZGFsOiBmYWxzZSwKICAgICAgICBpc1NhdmluZ0VkaXRlZFNuYXBwZWRBbnN3ZXI6IGZhbHNlCiAgICAgIH07CiAgICB9LAogICAgc2V0UHJldmlld2luZ01vZGUoc3RhdGUpIHsKICAgICAgc3RhdGUuc3RhdGVzID0gewogICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgaXNNYWluOiBmYWxzZSwKICAgICAgICBpc1ByZXZpZXdpbmc6IHRydWUsCiAgICAgICAgaXNQcmVwYXJpbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzTWFya2luZzogZmFsc2UsCiAgICAgICAgaXNTZWxlY3RpbmdTdGlja2VyOiBmYWxzZSwKICAgICAgICBpc1NlbGVjdGluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNab29taW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc1Bhbm5pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzRHJhd2luZzogZmFsc2UsCiAgICAgICAgaXNNb3ZpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzTW9kaWZ5aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1dyaXRpbmdGZWVkYmFjazogZmFsc2UsCiAgICAgICAgaXNTdWJtaXR0aW5nOiBmYWxzZSwKICAgICAgICBpc1Nob3dpbmdNb2RhbDogZmFsc2UsCiAgICAgICAgaXNTYXZpbmdFZGl0ZWRTbmFwcGVkQW5zd2VyOiBmYWxzZQogICAgICB9OwogICAgfSwKICAgIHRvZ2dsZVNlbGVjdGluZ09iamVjdE1vZGUoc3RhdGUpIHsKICAgICAgbGV0IGlzU2VsZWN0aW5nT2JqZWN0ID0gc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleC5nZXRBY3RpdmVPYmplY3QoKTsKICAgICAgc3RhdGUuc3RhdGVzID0gewogICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgaXNNYWluOiBmYWxzZSwKICAgICAgICBpc1ByZXZpZXdpbmc6IGZhbHNlLAogICAgICAgIGlzTWFya2luZzogdHJ1ZSwKICAgICAgICBpc1NlbGVjdGluZ1N0aWNrZXI6IGZhbHNlLAogICAgICAgIGlzU2VsZWN0aW5nT2JqZWN0OiBpc1NlbGVjdGluZ09iamVjdCwKICAgICAgICBpc1pvb21pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzUGFubmluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNEcmF3aW5nOiBmYWxzZSwKICAgICAgICBpc01vdmluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNNb2RpZnlpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzV3JpdGluZ0ZlZWRiYWNrOiBmYWxzZSwKICAgICAgICBpc0NoZWNraW5nU3VibWlzc2lvbjogZmFsc2UsCiAgICAgICAgaXNTdWJtaXR0aW5nOiBmYWxzZSwKICAgICAgICBpc1Nob3dpbmdNb2RhbDogZmFsc2UsCiAgICAgICAgaXNTYXZpbmdFZGl0ZWRTbmFwcGVkQW5zd2VyOiBmYWxzZQogICAgICB9OwogICAgfSwKICAgIHRvZ2dsZVByZXBhcmluZ0NhbnZhc01vZGUoc3RhdGUpIHsKICAgICAgc3RhdGUuc3RhdGVzID0gewogICAgICAgIGlzTG9hZGluZzogZmFsc2UsCiAgICAgICAgaXNNYWluOiBmYWxzZSwKICAgICAgICBpc1ByZXZpZXdpbmc6IHRydWUsCiAgICAgICAgaXNQcmVwYXJpbmdDYW52YXM6ICFzdGF0ZS5zdGF0ZXMuaXNQcmVwYXJpbmdDYW52YXMsCiAgICAgICAgaXNNYXJraW5nOiBmYWxzZSwKICAgICAgICBpc1NlbGVjdGluZ1N0aWNrZXI6IGZhbHNlLAogICAgICAgIGlzRHJhd2luZzogZmFsc2UsCiAgICAgICAgaXNNb3ZpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzU2NhbGluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNXcml0aW5nRmVlZGJhY2s6IGZhbHNlLAogICAgICAgIGlzQ2hlY2tpbmdTdWJtaXNzaW9uOiBmYWxzZSwKICAgICAgICBpc1N1Ym1pdHRpbmc6IGZhbHNlLAogICAgICAgIGlzU2hvd2luZ01vZGFsOiBmYWxzZSwKICAgICAgICBpc1NhdmluZ0VkaXRlZFNuYXBwZWRBbnN3ZXI6IGZhbHNlCiAgICAgIH07CiAgICB9LAogICAgdG9nZ2xlTW92aW5nT2JqZWN0TW9kZShzdGF0ZSkgewogICAgICBsZXQgaXNTZWxlY3RpbmdPYmplY3QgPSBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4LmdldEFjdGl2ZU9iamVjdCgpOwogICAgICBzdGF0ZS5zdGF0ZXMgPSB7CiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBpc01haW46IGZhbHNlLAogICAgICAgIGlzUHJldmlld2luZzogZmFsc2UsCiAgICAgICAgaXNQcmVwYXJpbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzTWFya2luZzogdHJ1ZSwKICAgICAgICBpc1NlbGVjdGluZ1N0aWNrZXI6IGZhbHNlLAogICAgICAgIGlzU2VsZWN0aW5nT2JqZWN0OiBzdGF0ZS5zdGF0ZXMuaXNNb3ZpbmdPYmplY3QgPyBpc1NlbGVjdGluZ09iamVjdCA6IGZhbHNlLAogICAgICAgIGlzWm9vbWluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNQYW5uaW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc0RyYXdpbmc6IGZhbHNlLAogICAgICAgIGlzTW92aW5nT2JqZWN0OiAhc3RhdGUuc3RhdGVzLmlzTW92aW5nT2JqZWN0LAogICAgICAgIGlzTW9kaWZ5aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1dyaXRpbmdGZWVkYmFjazogZmFsc2UsCiAgICAgICAgaXNTdWJtaXR0aW5nOiBmYWxzZSwKICAgICAgICBpc1Nob3dpbmdNb2RhbDogZmFsc2UsCiAgICAgICAgaXNTYXZpbmdFZGl0ZWRTbmFwcGVkQW5zd2VyOiBmYWxzZQogICAgICB9OwogICAgfSwKICAgIHRvZ2dsZUNhbnZhc1pvb21pbmdNb2RlKHN0YXRlKSB7CiAgICAgIHN0YXRlLnN0YXRlcyA9IHsKICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgICAgIGlzTWFpbjogZmFsc2UsCiAgICAgICAgaXNQcmV2aWV3aW5nOiBmYWxzZSwKICAgICAgICBpc01hcmtpbmc6IHRydWUsCiAgICAgICAgaXNTZWxlY3RpbmdTdGlja2VyOiBmYWxzZSwKICAgICAgICBpc1NlbGVjdGluZ09iamVjdDogZmFsc2UsCiAgICAgICAgaXNab29taW5nQ2FudmFzOiAhc3RhdGUuc3RhdGVzLmlzWm9vbWluZ0NhbnZhcywKICAgICAgICBpc1Bhbm5pbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzRHJhd2luZzogZmFsc2UsCiAgICAgICAgaXNNb3ZpbmdPYmplY3Q6IGZhbHNlLAogICAgICAgIGlzTW9kaWZ5aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc1dyaXRpbmdGZWVkYmFjazogZmFsc2UsCiAgICAgICAgaXNDaGVja2luZ1N1Ym1pc3Npb246IGZhbHNlLAogICAgICAgIGlzU3VibWl0dGluZzogZmFsc2UsCiAgICAgICAgaXNTaG93aW5nTW9kYWw6IGZhbHNlLAogICAgICAgIGlzU2F2aW5nRWRpdGVkU25hcHBlZEFuc3dlcjogZmFsc2UKICAgICAgfTsKICAgIH0sCiAgICB0b2dnbGVTY2FsaW5nT2JqZWN0TW9kZShzdGF0ZSkgewogICAgICBsZXQgaXNTZWxlY3RpbmdPYmplY3QgPSBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4LmdldEFjdGl2ZU9iamVjdCgpOwogICAgICBzdGF0ZS5zdGF0ZXMgPSB7CiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKICAgICAgICBpc01haW46IGZhbHNlLAogICAgICAgIGlzUHJldmlld2luZzogZmFsc2UsCiAgICAgICAgaXNQcmVwYXJpbmdDYW52YXM6IGZhbHNlLAogICAgICAgIGlzTWFya2luZzogdHJ1ZSwKICAgICAgICBpc1NlbGVjdGluZ1N0aWNrZXI6IGZhbHNlLAogICAgICAgIGlzU2VsZWN0aW5nT2JqZWN0OiBzdGF0ZS5zdGF0ZXMuaXNNb2RpZnlpbmdPYmplY3QgPyBpc1NlbGVjdGluZ09iamVjdCA6IGZhbHNlLAogICAgICAgIGlzWm9vbWluZ0NhbnZhczogZmFsc2UsCiAgICAgICAgaXNQYW5uaW5nQ2FudmFzOiBmYWxzZSwKICAgICAgICBpc0RyYXdpbmc6IGZhbHNlLAogICAgICAgIGlzTW92aW5nT2JqZWN0OiBmYWxzZSwKICAgICAgICBpc01vZGlmeWluZ09iamVjdDogIXN0YXRlLnN0YXRlcy5pc01vZGlmeWluZ09iamVjdCwKICAgICAgICBpc1dyaXRpbmdGZWVkYmFjazogZmFsc2UsCiAgICAgICAgaXNDaGVja2luZ1N1Ym1pc3Npb246IGZhbHNlLAogICAgICAgIGlzU3VibWl0dGluZzogZmFsc2UsCiAgICAgICAgaXNTaG93aW5nTW9kYWw6IGZhbHNlLAogICAgICAgIGlzU2F2aW5nRWRpdGVkU25hcHBlZEFuc3dlcjogZmFsc2UKICAgICAgfTsKICAgIH0sCiAgICAvLyBBdmFpbGFibGUgYWN0aW9uczogYWRkLCByZW1vdmUKICAgIHRvZ2dsZU92ZXJsYXlTY3JlZW4oc3RhdGUsIGFjdGlvbikgewogICAgICBpZiAoYWN0aW9uID09PSAnYWRkJyAmJiAhc3RhdGUubm93TWFya2luZy5pc092ZXJsYWlkKSB7CiAgICAgICAgaWYgKHN0YXRlLm5vd01hcmtpbmcub3ZlcmxheVNjcmVlbikgewogICAgICAgICAgc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleC5hZGQoc3RhdGUubm93TWFya2luZy5vdmVybGF5U2NyZWVuKS5yZW5kZXJBbGwoKTsKICAgICAgICAgIHN0YXRlLm5vd01hcmtpbmcub3ZlcmxheVNjcmVlbi5zZW5kQmFja3dhcmRzKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHN0YXRlLm5vd01hcmtpbmcub3ZlcmxheVNjcmVlbiA9IG5ldyBmYWJyaWMuUmVjdCh7CiAgICAgICAgICAgIGxlZnQ6IDAsCiAgICAgICAgICAgIHRvcDogMCwKICAgICAgICAgICAgZmlsbDogJ3JnYmEoMCwwLDAsIDAuNSknLAogICAgICAgICAgICB3aWR0aDogc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5kaW1lbnNpb25zLndpZHRoLAogICAgICAgICAgICBoZWlnaHQ6IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uZGltZW5zaW9ucy5oZWlnaHQsCiAgICAgICAgICAgIHNlbGVjdGFibGU6IGZhbHNlCiAgICAgICAgICB9KTsKICAgICAgICAgIHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uaW5kZXguYWRkKHN0YXRlLm5vd01hcmtpbmcub3ZlcmxheVNjcmVlbikucmVuZGVyQWxsKCk7CiAgICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLm92ZXJsYXlTY3JlZW4uc2VuZEJhY2t3YXJkcygpOwogICAgICAgIH0KICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLmlzT3ZlcmxhaWQgPSB0cnVlOwogICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PT0gJ3JlbW92ZScpIHsKICAgICAgICBpZiAoc3RhdGUubm93TWFya2luZy5vdmVybGF5U2NyZWVuKSB7CiAgICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4LnJlbW92ZShzdGF0ZS5ub3dNYXJraW5nLm92ZXJsYXlTY3JlZW4pOwogICAgICAgICAgc3RhdGUubm93TWFya2luZy5pc092ZXJsYWlkID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgcmVzZXRPYmplY3RTZWxlY3Rpb24oc3RhdGUpIHsKICAgICAgc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleC5kaXNjYXJkQWN0aXZlT2JqZWN0KCkucmVuZGVyQWxsKCk7CiAgICB9LAogICAgc2V0SW5pdGlhbENhbnZhc0RpbWVuc2lvbnMoc3RhdGUsIGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQpIHsKICAgICAgLy8gRGV0ZXJtaW5lIGNhbnZhcyBkaW1lbnNpb25zCiAgICAgIGxldCBjYW52YXNXaWR0aCA9IDAuOSAqIGNvbnRhaW5lcldpZHRoOwogICAgICAvLyBsZXQgY2FudmFzV2lkdGggPSAwLjkgKiB3aW5kb3cuaW5uZXJXaWR0aDsKICAgICAgLy8gaWYgKHdpbmRvdy5pbm5lcldpZHRoID4gNzAwKSB7CiAgICAgIC8vICAgICBpZiAod2luZG93LmlubmVyV2lkdGggPiAxMDAwKSB7CiAgICAgIC8vICAgICAgICAgY2FudmFzV2lkdGggPSAwLjkgKiBjb250YWluZXJXaWR0aDsKICAgICAgLy8gY2FudmFzV2lkdGggPSAwLjUgKiB3aW5kb3cuaW5uZXJXaWR0aDsKICAgICAgLy8gfSBlbHNlIHsKICAgICAgLy8gICAgIGNhbnZhc1dpZHRoID0gMC45ICogY29udGFpbmVyV2lkdGg7CiAgICAgIC8vIGNhbnZhc1dpZHRoID0gMC42NSAqIHdpbmRvdy5pbm5lcldpZHRoOwogICAgICAvLyAgICAgfQogICAgICAvLyB9CgogICAgICBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmRpbWVuc2lvbnMgPSB7CiAgICAgICAgaGVpZ2h0OiBjb250YWluZXJIZWlnaHQsCiAgICAgICAgd2lkdGg6IGNhbnZhc1dpZHRoCiAgICAgICAgLy8gaGVpZ2h0OiAwLjc1ICogd2luZG93LmlubmVySGVpZ2h0LAogICAgICAgIC8vIHdpZHRoOiAwLjkgKiB3aW5kb3cuaW5uZXJXaWR0aAogICAgICB9OwogICAgfSwKCiAgICByZXNldFN0YXRlKHN0YXRlKSB7CiAgICAgIE9iamVjdC5hc3NpZ24oc3RhdGUsIGdldERlZmF1bHRTdGF0ZSgpKTsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIC8vIEZFVENIOiBTdWJtaXNzaW9uIERldGFpbHMKICAgIGZldGNoRGF0YSh7CiAgICAgIHN0YXRlLAogICAgICBjb21taXQKICAgIH0sIHN1Ym1pc3Npb25JRCkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgIFN1Ym1pc3Npb25SZXBvc2l0b3J5LmZpbmQoc3VibWlzc2lvbklEKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgY29tbWl0KCdzZXRBc3NpZ25tZW50RGV0YWlscycsIHJlc3BvbnNlLmRhdGEuZGF0YSk7CiAgICAgICAgICAgIHN0YXRlLnN0YXRlcy5pc0xvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVqZWN0KCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioKICAgICBDb252ZXJ0IHNuYXBwZWQgYW5zd2VycyB0byBkYXRhVVJMIGFzeW5jaHJvbm91c2x5CiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIGJ1bGtDb252ZXJ0U3VibWlzc2lvbnNUb0RhdGFVUkwoewogICAgICBzdGF0ZSwKICAgICAgZ2V0dGVycywKICAgICAgY29tbWl0CiAgICB9KSB7CiAgICAgIGxldCB0b0NvbnZlcnQgPSBzdGF0ZS5tYXJraW5nLmxlbmd0aDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICBzdGF0ZS5tYXJraW5nLmZvckVhY2goKGltYWdlUGF0aCwgaW5kZXgpID0+IHsKICAgICAgICAgIC8vIENoZWNrIGlmIGltYWdlIGlzIGFscmVhZHkgY29udmVydGVkIHRvIGRhdGFVUkwKICAgICAgICAgIGxldCBpc0NvbnZlcnRlZCA9IGltYWdlUGF0aC5zcGxpdCgiLCIpWzBdID09PSAnZGF0YTppbWFnZS9qcGc7YmFzZTY0JyB8fCBpbWFnZVBhdGguc3BsaXQoIiwiKVswXSA9PT0gJ2RhdGE6aW1hZ2UvanBlZztiYXNlNjQnIHx8IGltYWdlUGF0aC5zcGxpdCgiLCIpWzBdID09PSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0JzsKCiAgICAgICAgICAvLyBJZiBub3QgeWV0LCBjb252ZXJ0IG5vdwogICAgICAgICAgaWYgKCFpc0NvbnZlcnRlZCkgewogICAgICAgICAgICBTdWJtaXNzaW9uUmVwb3NpdG9yeS5jb252ZXJ0VG9EYXRhVVJMKGltYWdlUGF0aCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgc3RhdGUubWFya2luZ1tpbmRleF0gPSBkZWNvZGVVUklDb21wb25lbnQocmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICAgICAgICAgIHRvQ29udmVydC0tOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRmFpbGVkIHRvIGNvbnZlcnQgaW1hZ2UgdG8gZGF0YVVSTCcpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGYWlsZWQgdG8gY29udmVydCBpbWFnZSB0byBkYXRhVVJMJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdG9Db252ZXJ0LS07CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGNoZWNrQWxsQ29udmVydGVkVG9EYXRhVVJMKHsKICAgICAgc3RhdGUKICAgIH0pIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICBsZXQgdG9DaGVjayA9IHN0YXRlLm1hcmtpbmcubGVuZ3RoOwogICAgICAgIHN0YXRlLm1hcmtpbmcuZm9yRWFjaCgoaW1hZ2VQYXRoLCBpbmRleCkgPT4gewogICAgICAgICAgbGV0IGlzQ29udmVydGVkID0gaW1hZ2VQYXRoLnNwbGl0KCIsIilbMF0gPT09ICdkYXRhOmltYWdlL2pwZztiYXNlNjQnIHx8IGltYWdlUGF0aC5zcGxpdCgiLCIpWzBdID09PSAnZGF0YTppbWFnZS9wbmc7YmFzZTY0JzsKICAgICAgICAgIGlmIChpc0NvbnZlcnRlZCkgewogICAgICAgICAgICB0b0NoZWNrLS07CiAgICAgICAgICAgIGlmICh0b0NoZWNrID09PSAwKSB7CiAgICAgICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QoJ1BsZWFzZSB0cnkgYWdhaW4nKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZW50ZXJNYXJraW5nTW9kZSh7CiAgICAgIHN0YXRlLAogICAgICBnZXR0ZXJzLAogICAgICBjb21taXQKICAgIH0sIG5vd01hcmtpbmcpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICBpZiAoc3RhdGUuc3RhdGVzLmlzUHJldmlld2luZyAmJiAhZ2V0dGVycy5pc01hcmtlZEFzc2lnbm1lbnQpIHsKICAgICAgICAgIC8vIENoZWNrIGlmIGltYWdlIGlzIGFscmVhZHkgY29udmVydGVkIHRvIGRhdGFVUkwKICAgICAgICAgIGxldCBpc0NvbnZlcnRlZCA9IG5vd01hcmtpbmcucGF0aC5zcGxpdCgiLCIpWzBdID09PSAnZGF0YTppbWFnZS9qcGc7YmFzZTY0JzsKICAgICAgICAgIGlmIChpc0NvbnZlcnRlZCkgewogICAgICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLmltYWdlLmluZGV4ID0gbm93TWFya2luZy5pbmRleDsKICAgICAgICAgICAgc3RhdGUubm93TWFya2luZy5pbWFnZS5wYXRoID0gbm93TWFya2luZy5wYXRoOwogICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBTdWJtaXNzaW9uUmVwb3NpdG9yeS5jb252ZXJ0VG9EYXRhVVJMKG5vd01hcmtpbmcucGF0aCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgc3RhdGUubm93TWFya2luZy5pbWFnZS5pbmRleCA9IG5vd01hcmtpbmcuaW5kZXg7CiAgICAgICAgICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLmltYWdlLnBhdGggPSBkZWNvZGVVUklDb21wb25lbnQocmVzcG9uc2UuZGF0YS5kYXRhKTsKICAgICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmVqZWN0KCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICAgICAgcmVqZWN0KCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZWplY3QoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8qKioqKioqKioqKgogICAgIFNFUVVFTkNFOgogICAgIDEpIEdldCBpbWFnZSBzaXplCiAgICAgMikgQ3JlYXRlIG5ldyBjYW52YXMKICAgICAzKSBTZXQgY2FudmFzIGJhY2tncm91bmQgaW1hZ2UKICAgICA0KSBFbmFibGUgYWN0aW9ucwogICAgICogKi8KICAgIGluaXRpYWxpc2VNYXJraW5nQ2FudmFzKHsKICAgICAgc3RhdGUsCiAgICAgIGNvbW1pdCwKICAgICAgZGlzcGF0Y2gsCiAgICAgIHJvb3RHZXR0ZXJzCiAgICB9KSB7CiAgICAgIGRpc3BhdGNoKCdnZXRTbmFwcGVkQW5zd2VyRGltZW5zaW9ucycpLnRoZW4oKCkgPT4gewogICAgICAgIGxldCBzY2FsZUZhY3RvciA9IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uZGltZW5zaW9ucy53aWR0aCAvIHN0YXRlLm5vd01hcmtpbmcuaW1hZ2UuZGltZW5zaW9ucy53aWR0aDsKCiAgICAgICAgLy8gRGV0ZXJtaW5lIGlmIGltYWdlIGlzIGxvbmdlciB0aGFuIHNjcmVlbiBoZWlnaHQKICAgICAgICBsZXQgaW1hZ2VJc0xvbmdlclRoYW5TY3JlZW5IZWlnaHQgPSBzY2FsZUZhY3RvciAqIHN0YXRlLm5vd01hcmtpbmcuaW1hZ2UuZGltZW5zaW9ucy5oZWlnaHQgPiAwLjcgKiB3aW5kb3cuaW5uZXJIZWlnaHQ7CgogICAgICAgIC8vIFNldCBjYW52YXMgc2l6ZQogICAgICAgIHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uaW5kZXggPSBuZXcgZmFicmljLkNhbnZhcygnY2FudmFzX3NuYXBwZWRfYW5zd2VyJywgewogICAgICAgICAgd2lkdGg6IHNjYWxlRmFjdG9yICogc3RhdGUubm93TWFya2luZy5pbWFnZS5kaW1lbnNpb25zLndpZHRoLAogICAgICAgICAgaGVpZ2h0OiBpbWFnZUlzTG9uZ2VyVGhhblNjcmVlbkhlaWdodCA/IHNjYWxlRmFjdG9yICogc3RhdGUubm93TWFya2luZy5pbWFnZS5kaW1lbnNpb25zLmhlaWdodCA6IHNjYWxlRmFjdG9yICogc3RhdGUubm93TWFya2luZy5pbWFnZS5kaW1lbnNpb25zLmhlaWdodCArIDAuMyAqIHdpbmRvdy5pbm5lckhlaWdodAogICAgICAgIH0pOwoKICAgICAgICAvLyBTdG9yZSBjYW52YXMgZGltZW5zaW9uIHZhbHVlcwogICAgICAgIHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uZGltZW5zaW9ucyA9IHsKICAgICAgICAgIHdpZHRoOiBzY2FsZUZhY3RvciAqIHN0YXRlLm5vd01hcmtpbmcuaW1hZ2UuZGltZW5zaW9ucy53aWR0aCwKICAgICAgICAgIGhlaWdodDogaW1hZ2VJc0xvbmdlclRoYW5TY3JlZW5IZWlnaHQgPyBzY2FsZUZhY3RvciAqIHN0YXRlLm5vd01hcmtpbmcuaW1hZ2UuZGltZW5zaW9ucy5oZWlnaHQgOiBzY2FsZUZhY3RvciAqIHN0YXRlLm5vd01hcmtpbmcuaW1hZ2UuZGltZW5zaW9ucy5oZWlnaHQgKyAwLjMgKiB3aW5kb3cuaW5uZXJIZWlnaHQKICAgICAgICAgIC8vIGhlaWdodDogaW1hZ2VJc0xvbmdlclRoYW5TY3JlZW5IZWlnaHQgPyBzY2FsZUZhY3RvciAqIHN0YXRlLm5vd01hcmtpbmcuaW1hZ2UuZGltZW5zaW9ucy5oZWlnaHQgOiAwLjcgKiB3aW5kb3cuaW5uZXJIZWlnaHQsCiAgICAgICAgfTsKCiAgICAgICAgLy8gU2V0IGJhY2tncm91bmQgaW1hZ2Ugb2YgbWFpbiBjYW52YXMKICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4LnNldEJhY2tncm91bmRJbWFnZShzdGF0ZS5ub3dNYXJraW5nLmltYWdlLnBhdGgsIHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uaW5kZXgucmVuZGVyQWxsLmJpbmQoc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleCksIHsKICAgICAgICAgIHRvcDogaW1hZ2VJc0xvbmdlclRoYW5TY3JlZW5IZWlnaHQgPyAwIDogc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5kaW1lbnNpb25zLmhlaWdodCAvIDMsCiAgICAgICAgICBsZWZ0OiBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmRpbWVuc2lvbnMud2lkdGggLyAyLAogICAgICAgICAgb3JpZ2luWDogJ2NlbnRlcicsCiAgICAgICAgICBvcmlnaW5ZOiBpbWFnZUlzTG9uZ2VyVGhhblNjcmVlbkhlaWdodCA/ICd0b3AnIDogJ2NlbnRlcicsCiAgICAgICAgICBzY2FsZVg6IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uZGltZW5zaW9ucy53aWR0aCAvIHN0YXRlLm5vd01hcmtpbmcuaW1hZ2UuZGltZW5zaW9ucy53aWR0aCwKICAgICAgICAgIHNjYWxlWTogc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5kaW1lbnNpb25zLndpZHRoIC8gc3RhdGUubm93TWFya2luZy5pbWFnZS5kaW1lbnNpb25zLndpZHRoCiAgICAgICAgfSwgewogICAgICAgICAgY3Jvc3NPcmlnaW46ICdBbm9ueW1vdXMnCiAgICAgICAgfSk7CgogICAgICAgIC8vIEVuYWJsZS9kaXNhYmxlIG1hcmtpbmcgZnVuY3Rpb25zCiAgICAgICAgZGlzcGF0Y2goJ2VuYWJsZURyYWdBbmREcm9wVG9UcmFzaCcpOwoKICAgICAgICAvLyBDdXJyZW50bHkgZW5hYmxlIG9ubHkgZm9yIHRlc3QgYWNjb3VudAogICAgICAgIGlmIChyb290R2V0dGVyc1snZ2V0QXV0aEVtYWlsJ10gPT09ICdjaWtndUBzbmFwcGVkLmNvbScgfHwgcm9vdEdldHRlcnNbJ2dldEF1dGhFbWFpbCddID09PSAnY2lrZ3VtYXJpYUBzbmFwcGVkLmNvbScpIHsKICAgICAgICAgIGRpc3BhdGNoKCdlbmFibGVDYW52YXNab29tJyk7CiAgICAgICAgICBkaXNwYXRjaCgnZW5hYmxlQ2FudmFzUGFubmluZycpOwogICAgICAgIH0KICAgICAgICBkaXNwYXRjaCgnaGFuZGxlT2JqZWN0TW9kaWZpY2F0aW9uJyk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldFNuYXBwZWRBbnN3ZXJEaW1lbnNpb25zKHsKICAgICAgc3RhdGUsCiAgICAgIGNvbW1pdCwKICAgICAgZGlzcGF0Y2gKICAgIH0pIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICBmYWJyaWMuSW1hZ2UuZnJvbVVSTChzdGF0ZS5ub3dNYXJraW5nLmltYWdlLnBhdGgsIChpbWcsIGVycm9yKSA9PiB7CiAgICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLmltYWdlLmRpbWVuc2lvbnMud2lkdGggPSBpbWcud2lkdGg7CiAgICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLmltYWdlLmRpbWVuc2lvbnMuaGVpZ2h0ID0gaW1nLmhlaWdodDsKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLyoqKioqKioqKioqKioqKioqCiAgICAgKiBDQU5WQVM6IFpPT00KICAgICAqKioqKioqKioqKioqKioqLwogICAgZW5hYmxlQ2FudmFzWm9vbSh7CiAgICAgIHN0YXRlLAogICAgICBjb21taXQsCiAgICAgIGRpc3BhdGNoCiAgICB9KSB7CiAgICAgIGxldCBjYW52YXMgPSBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4OwoKICAgICAgLy8gVHJhY2sgY2FudmFzIGV2ZW50cwogICAgICBjYW52YXMub24oewogICAgICAgIC8vIE9OIE1PVVNFIFdIRUVMCiAgICAgICAgJ21vdXNlOndoZWVsJzogZnVuY3Rpb24gKG9wdCkgewogICAgICAgICAgY29tbWl0KCd0b2dnbGVDYW52YXNab29taW5nTW9kZScpOwogICAgICAgICAgaWYgKHN0YXRlLnN0YXRlcy5pc1pvb21pbmdDYW52YXMpIHsKICAgICAgICAgICAgbGV0IGRlbHRhID0gb3B0LmUuZGVsdGFZOwogICAgICAgICAgICBsZXQgem9vbSA9IGNhbnZhcy5nZXRab29tKCk7CiAgICAgICAgICAgIHpvb20gKj0gMC45OTkgKiogZGVsdGE7CiAgICAgICAgICAgIGlmICh6b29tID4gNikgem9vbSA9IDY7CiAgICAgICAgICAgIGlmICh6b29tIDwgMSkgem9vbSA9IDE7CiAgICAgICAgICAgIGNhbnZhcy56b29tVG9Qb2ludCh7CiAgICAgICAgICAgICAgeDogb3B0LmUub2Zmc2V0WCwKICAgICAgICAgICAgICB5OiBvcHQuZS5vZmZzZXRZCiAgICAgICAgICAgIH0sIHpvb20pOwogICAgICAgICAgICBvcHQuZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICBvcHQuZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgbGV0IHZwdCA9IHRoaXMudmlld3BvcnRUcmFuc2Zvcm07CiAgICAgICAgICAgIGlmICh6b29tIDwgNDAwIC8gMTAwMCkgewogICAgICAgICAgICAgIHZwdFs0XSA9IDIwMCAtIDEwMDAgKiB6b29tIC8gMjsKICAgICAgICAgICAgICB2cHRbNV0gPSAyMDAgLSAxMDAwICogem9vbSAvIDI7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgaWYgKHZwdFs0XSA+PSAwKSB7CiAgICAgICAgICAgICAgICB2cHRbNF0gPSAwOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAodnB0WzRdIDwgY2FudmFzLmdldFdpZHRoKCkgLSAxMDAwICogem9vbSkgewogICAgICAgICAgICAgICAgdnB0WzRdID0gY2FudmFzLmdldFdpZHRoKCkgLSAxMDAwICogem9vbTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHZwdFs1XSA+PSAwKSB7CiAgICAgICAgICAgICAgICB2cHRbNV0gPSAwOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAodnB0WzVdIDwgY2FudmFzLmdldEhlaWdodCgpIC0gMTAwMCAqIHpvb20pIHsKICAgICAgICAgICAgICAgIHZwdFs1XSA9IGNhbnZhcy5nZXRIZWlnaHQoKSAtIDEwMDAgKiB6b29tOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBjb21taXQoJ3RvZ2dsZUNhbnZhc1pvb21pbmdNb2RlJyk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAndG91Y2g6Z2VzdHVyZSc6IGZ1bmN0aW9uIChvcHQpIHsKICAgICAgICAgIC8vIElmIHVzZXIgcGluY2ggdG8gem9vbQogICAgICAgICAgaWYgKG9wdC5lLnRvdWNoZXMgJiYgb3B0LmUudG91Y2hlcy5sZW5ndGggPT09IDIgJiYgIXN0YXRlLnN0YXRlcy5pc01vZGlmeWluZ09iamVjdCkgewogICAgICAgICAgICBpZiAoc3RhdGUuc3RhdGVzLmlzU2VsZWN0aW5nT2JqZWN0KSB7CiAgICAgICAgICAgICAgY29tbWl0KCdyZXNldE9iamVjdFNlbGVjdGlvbicpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbW1pdCgndG9nZ2xlQ2FudmFzWm9vbWluZ01vZGUnKTsKCiAgICAgICAgICAgIC8vIGRpc3BhdGNoKCdhZGREZWJ1Z01lc3NhZ2UnLCBzdGF0ZUNoYW5nZSkKCiAgICAgICAgICAgIGlmIChzdGF0ZS5zdGF0ZXMuaXNab29taW5nQ2FudmFzKSB7CiAgICAgICAgICAgICAgLy8gZGlzcGF0Y2goJ2FkZERlYnVnTWVzc2FnZScsIFsKICAgICAgICAgICAgICAvLyAgICAgYHRvdWNoIGdlc3R1cmUgOiAke29wdC5lLnRvdWNoZXMubGVuZ3RofWAsCiAgICAgICAgICAgICAgLy8gICAgIGBpcyB6b29taW5nOiAke3N0YXRlLnN0YXRlcy5pc1pvb21pbmdDYW52YXN9YCwKICAgICAgICAgICAgICAvLyAgICAgYGlzIHNlbGVjdGluZzogJHtzdGF0ZS5zdGF0ZXMuaXNTZWxlY3RpbmdPYmplY3R9YAogICAgICAgICAgICAgIC8vIF0pCgogICAgICAgICAgICAgIC8vIGRpc3BhdGNoKCdhZGREZWJ1Z01lc3NhZ2UnLCBgem9vbWluZ2ApCgogICAgICAgICAgICAgIC8vIEdldCBpbml0aWFsIGNhbnZhcyB6b29tIHZhbHVlIGFuZCBpbml0aWFsIGdlc3R1cmUgc2NhbGUgdmFsdWUKICAgICAgICAgICAgICBsZXQgem9vbSA9IGNhbnZhcy5nZXRab29tKCk7CiAgICAgICAgICAgICAgbGV0IGRlbHRhID0gb3B0LnNlbGYuc2NhbGU7CiAgICAgICAgICAgICAgaWYgKG9wdC5zZWxmLnN0YXRlID09PSAic3RhcnQiKSB7CiAgICAgICAgICAgICAgICB6b29tID0gZGVsdGEgPiAxID8gem9vbSArIDEgOiB6b29tOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8gU2xvdyB6b29tIGluLCBxdWlja2VyIHpvb20gb3V0CiAgICAgICAgICAgICAgaWYgKGRlbHRhID4gMSkgewogICAgICAgICAgICAgICAgem9vbSA9IHpvb20gKiAxLjAxICoqIGRlbHRhOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB6b29tID0gem9vbSAqKiBkZWx0YTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIC8vIFNldCBtYXggem9vbSBpbiBhbmQgbWF4IHpvb20gb3V0CiAgICAgICAgICAgICAgaWYgKHpvb20gPiA0KSB6b29tID0gNDsKICAgICAgICAgICAgICBpZiAoem9vbSA8IDEpIHpvb20gPSAxOwoKICAgICAgICAgICAgICAvLyBEZXRlcm1pbmUgcG9pbnQgb2Ygc2NhbGluZwogICAgICAgICAgICAgIGxldCBwb2ludCA9IG5ldyBmYWJyaWMuUG9pbnQob3B0LnNlbGYueCwgb3B0LnNlbGYueSk7CiAgICAgICAgICAgICAgaWYgKHpvb20gPCAxKSBwb2ludCA9IG5ldyBmYWJyaWMuUG9pbnQoY2FudmFzLndpZHRoIC8gMiwgY2FudmFzLmhlaWdodCAvIDIpOwoKICAgICAgICAgICAgICAvLyAvLyBab29tIHRvIHBpbmNoIHBvaW50CiAgICAgICAgICAgICAgY2FudmFzLnpvb21Ub1BvaW50KHBvaW50LCB6b29tKTsKICAgICAgICAgICAgICBjb21taXQoJ3RvZ2dsZUNhbnZhc1pvb21pbmdNb2RlJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogICAgICogQ0FOVkFTOiBEUkFHICYgRFJPUCBUTyBUUkFTSAogICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICBlbmFibGVEcmFnQW5kRHJvcFRvVHJhc2goewogICAgICBzdGF0ZSwKICAgICAgY29tbWl0LAogICAgICBkaXNwYXRjaAogICAgfSkgewogICAgICBsZXQgY2FudmFzID0gc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleDsKICAgICAgY2FudmFzLm9uKHt9KTsKICAgIH0sCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgICAqIENBTlZBUzogUEFOTklORwogICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICBlbmFibGVDYW52YXNQYW5uaW5nKHsKICAgICAgc3RhdGUsCiAgICAgIGNvbW1pdCwKICAgICAgZGlzcGF0Y2gKICAgIH0pIHsKICAgICAgbGV0IGNhbnZhcyA9IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uaW5kZXg7CgogICAgICAvLyBPTiBERVNLVE9QCiAgICAgIGNhbnZhcy5vbih7CiAgICAgICAgJ21vdXNlOmRvd24nOiBmdW5jdGlvbiAob3B0KSB7CiAgICAgICAgICBsZXQgZXZlbnQgPSBvcHQuZTsKICAgICAgICAgIGlmIChldmVudC5hbHRLZXkgPT09IHRydWUpIHsKICAgICAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb24gPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5sYXN0UG9zWCA9IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WDsKICAgICAgICAgICAgdGhpcy5sYXN0UG9zWSA9IGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICdtb3VzZTptb3ZlJzogZnVuY3Rpb24gKG9wdCkgewogICAgICAgICAgaWYgKHRoaXMuaXNEcmFnZ2luZykgewogICAgICAgICAgICBsZXQgZXZlbnQgPSBvcHQuZTsKICAgICAgICAgICAgbGV0IHZwdCA9IHRoaXMudmlld3BvcnRUcmFuc2Zvcm07CiAgICAgICAgICAgIHZwdFs0XSArPSBldmVudC50b3VjaGVzWzBdLmNsaWVudFggLSB0aGlzLmxhc3RQb3NYOwogICAgICAgICAgICB2cHRbNV0gKz0gZXZlbnQudG91Y2hlc1swXS5jbGllbnRZIC0gdGhpcy5sYXN0UG9zWTsKICAgICAgICAgICAgdGhpcy5yZXF1ZXN0UmVuZGVyQWxsKCk7CiAgICAgICAgICAgIHRoaXMubGFzdFBvc1ggPSBldmVudC50b3VjaGVzWzBdLmNsaWVudFg7CiAgICAgICAgICAgIHRoaXMubGFzdFBvc1kgPSBldmVudC50b3VjaGVzWzBdLmNsaWVudFk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAnbW91c2U6dXAnOiBmdW5jdGlvbiAob3B0KSB7CiAgICAgICAgICAvLyBvbiBtb3VzZSB1cCB3ZSB3YW50IHRvIHJlY2FsY3VsYXRlIG5ldyBpbnRlcmFjdGlvbgogICAgICAgICAgLy8gZm9yIGFsbCBvYmplY3RzLCBzbyB3ZSBjYWxsIHNldFZpZXdwb3J0VHJhbnNmb3JtCiAgICAgICAgICB0aGlzLnNldFZpZXdwb3J0VHJhbnNmb3JtKHRoaXMudmlld3BvcnRUcmFuc2Zvcm0pOwogICAgICAgICAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLnNlbGVjdGlvbiA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8vIE9OIE1PQklMRQogICAgICBjYW52YXMub24oewogICAgICAgICd0b3VjaDpkcmFnJzogZnVuY3Rpb24gKG9wdCkgewogICAgICAgICAgLy8gRW5zdXJlIHNpbmdsZSBmaW5nZXIgdG91Y2ggYW5kIG5vdCBwZXJmb3JtaW5nIG90aGVyIGFjdGlvbnMKICAgICAgICAgIGlmIChvcHQuZS50b3VjaGVzICYmIG9wdC5lLnRvdWNoZXMubGVuZ3RoID09PSAxICYmICFzdGF0ZS5zdGF0ZXMuaXNNb3ZpbmdPYmplY3QgJiYgIXN0YXRlLnN0YXRlcy5pc01vZGlmeWluZ09iamVjdCAmJiAhc3RhdGUuc3RhdGVzLmlzRHJhd2luZykgewogICAgICAgICAgICB0aGlzLnNlbGVjdGlvbiA9IGZhbHNlOwogICAgICAgICAgICBsZXQgaW5pdGlhbFggPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9wdC5zZWxmLnN0YXJ0LngpKTsKICAgICAgICAgICAgbGV0IGluaXRpYWxZID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvcHQuc2VsZi5zdGFydC55KSk7CgogICAgICAgICAgICAvLyBHZXQgbGFzdCBwb2ludAogICAgICAgICAgICBsZXQgbGFzdFggPSBvcHQuc2VsZi54OwogICAgICAgICAgICBsZXQgbGFzdFkgPSBvcHQuc2VsZi55OwogICAgICAgICAgICBsZXQgZGVsdGFYID0gbGFzdFggLSBpbml0aWFsWDsKICAgICAgICAgICAgbGV0IGRlbHRhWSA9IGxhc3RZIC0gaW5pdGlhbFk7CiAgICAgICAgICAgIGxldCBkZWx0YSA9IG5ldyBmYWJyaWMuUG9pbnQoZGVsdGFYIC8gMjAsIGRlbHRhWSAvIDIwKTsKICAgICAgICAgICAgY2FudmFzLnJlbGF0aXZlUGFuKGRlbHRhKTsKICAgICAgICAgICAgc3RhdGUuZHJhZ0NvdW50Kys7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVPYmplY3RNb2RpZmljYXRpb24oewogICAgICBzdGF0ZSwKICAgICAgY29tbWl0LAogICAgICBkaXNwYXRjaAogICAgfSkgewogICAgICBsZXQgY2FudmFzID0gc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleDsKICAgICAgY2FudmFzLm9uKHsKICAgICAgICAnb2JqZWN0OnNjYWxpbmcnOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIC8vIElmIHN0YXRlIGlzTW92aW5nT2JqZWN0IG5vdCBhbHJlYWR5IHNldCwgc2V0IHRvIHRydWUKICAgICAgICAgIGlmIChldmVudC5lLnRvdWNoZXMubGVuZ3RoID09PSAxICYmICFzdGF0ZS5zdGF0ZXMuaXNNb2RpZnlpbmdPYmplY3QgJiYgIXN0YXRlLnN0YXRlcy5pc1pvb21pbmdDYW52YXMpIHsKICAgICAgICAgICAgY29tbWl0KCd0b2dnbGVTY2FsaW5nT2JqZWN0TW9kZScpOwogICAgICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLnNlbGVjdGVkT2JqZWN0ID0gZXZlbnQudGFyZ2V0OwogICAgICAgICAgICBjb21taXQoJ3RvZ2dsZU92ZXJsYXlTY3JlZW4nLCAnYWRkJyk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZXZlbnQuZS50b3VjaGVzLmxlbmd0aCA9PT0gMikgewogICAgICAgICAgICBjb21taXQoJ3Jlc2V0T2JqZWN0U2VsZWN0aW9uJyk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAnb2JqZWN0OnNjYWxlZCc6IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgY29tbWl0KCd0b2dnbGVTY2FsaW5nT2JqZWN0TW9kZScpOwogICAgICAgICAgY29tbWl0KCd0b2dnbGVPdmVybGF5U2NyZWVuJywgJ3JlbW92ZScpOwogICAgICAgIH0sCiAgICAgICAgJ29iamVjdDpyb3RhdGluZyc6IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgLy8gSWYgc3RhdGUgaXNNb3ZpbmdPYmplY3Qgbm90IGFscmVhZHkgc2V0LCBzZXQgdG8gdHJ1ZQogICAgICAgICAgaWYgKGV2ZW50LmUudG91Y2hlcy5sZW5ndGggPT09IDEgJiYgIXN0YXRlLnN0YXRlcy5pc01vZGlmeWluZ09iamVjdCAmJiAhc3RhdGUuc3RhdGVzLmlzWm9vbWluZ0NhbnZhcykgewogICAgICAgICAgICBjb21taXQoJ3RvZ2dsZVNjYWxpbmdPYmplY3RNb2RlJyk7CiAgICAgICAgICAgIHN0YXRlLm5vd01hcmtpbmcuc2VsZWN0ZWRPYmplY3QgPSBldmVudC50YXJnZXQ7CiAgICAgICAgICAgIGNvbW1pdCgndG9nZ2xlT3ZlcmxheVNjcmVlbicsICdhZGQnKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICdvYmplY3Q6cm90YXRlZCc6IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgY29tbWl0KCd0b2dnbGVTY2FsaW5nT2JqZWN0TW9kZScpOwogICAgICAgICAgY29tbWl0KCd0b2dnbGVPdmVybGF5U2NyZWVuJywgJ3JlbW92ZScpOwogICAgICAgIH0sCiAgICAgICAgJ29iamVjdDptb3ZpbmcnOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIC8vIElmIHN0YXRlIGlzTW92aW5nT2JqZWN0IG5vdCBhbHJlYWR5IHNldCwgc2V0IHRvIHRydWUKICAgICAgICAgIGlmICghc3RhdGUuc3RhdGVzLmlzTW92aW5nT2JqZWN0ICYmIGV2ZW50LmUudG91Y2hlcy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgICAgY29tbWl0KCd0b2dnbGVNb3ZpbmdPYmplY3RNb2RlJyk7CiAgICAgICAgICAgIHN0YXRlLm5vd01hcmtpbmcuc2VsZWN0ZWRPYmplY3QgPSBldmVudC50YXJnZXQ7CiAgICAgICAgICAgIGNvbW1pdCgndG9nZ2xlT3ZlcmxheVNjcmVlbicsICdhZGQnKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICdvYmplY3Q6bW92ZWQnOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGNvbW1pdCgndG9nZ2xlTW92aW5nT2JqZWN0TW9kZScpOwogICAgICAgICAgY29tbWl0KCd0b2dnbGVPdmVybGF5U2NyZWVuJywgJ3JlbW92ZScpOwogICAgICAgIH0sCiAgICAgICAgJ3NlbGVjdGlvbjpjcmVhdGVkJzogZnVuY3Rpb24gKCkgewogICAgICAgICAgY29tbWl0KCd0b2dnbGVTZWxlY3RpbmdPYmplY3RNb2RlJyk7CiAgICAgICAgfSwKICAgICAgICAnc2VsZWN0aW9uOnVwZGF0ZWQnOiBmdW5jdGlvbiAoKSB7fSwKICAgICAgICAnc2VsZWN0aW9uOmNsZWFyZWQnOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBjb21taXQoJ3RvZ2dsZVNlbGVjdGluZ09iamVjdE1vZGUnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGxvYWRTdGlja2VyKHsKICAgICAgc3RhdGUsCiAgICAgIGNvbW1pdAogICAgfSwgc3RpY2tlck5hbWUpIHsKICAgICAgZmFicmljLmxvYWRTVkdGcm9tU3RyaW5nKHN0aWNrZXJzW3N0aWNrZXJOYW1lXSwgKG9iamVjdHMsIG9wdGlvbnMpID0+IHsKICAgICAgICBsZXQgb2JqID0gZmFicmljLnV0aWwuZ3JvdXBTVkdFbGVtZW50cyhvYmplY3RzLCBvcHRpb25zKTsKICAgICAgICBvYmouc2NhbGVUb0hlaWdodChzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmRpbWVuc2lvbnMuaGVpZ2h0IC8gMTIpLnNldCh7CiAgICAgICAgICBsZWZ0OiBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmRpbWVuc2lvbnMud2lkdGggLyAyLAogICAgICAgICAgdG9wOiBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmRpbWVuc2lvbnMuaGVpZ2h0IC8gMgogICAgICAgIH0pLnNldENvb3JkcygpOwogICAgICAgIHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uaW5kZXguYWRkKG9iaikucmVuZGVyQWxsKCk7CiAgICAgIH0pOwogICAgICBjb21taXQoJ3RvZ2dsZVN0aWNrZXJCYXInKTsKICAgIH0sCiAgICBsb2FkVGV4dEJveCh7CiAgICAgIHN0YXRlLAogICAgICBjb21taXQKICAgIH0pIHsKICAgICAgLy8gbGV0IG9sZFRvcCA9IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uZGltZW5zaW9ucy5oZWlnaHQgLyAyOwogICAgICAvLyBsZXQgb2xkTGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gMjsKCiAgICAgIGxldCBvbGRUb3AgPSBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmRpbWVuc2lvbnMud2lkdGggLyAyOwogICAgICBsZXQgb2xkTGVmdCA9IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uZGltZW5zaW9ucy53aWR0aCAvIDI7CiAgICAgIC8vIGxldCBvbGRUb3AgPSB3aW5kb3cuaW5uZXJXaWR0aCAvIDI7CiAgICAgIC8vIGxldCBvbGRMZWZ0ID0gd2luZG93LmlubmVyV2lkdGggLyAyOwoKICAgICAgbGV0IHRleHRCb3ggPSBuZXcgZmFicmljLlRleHRib3goJycsIHsKICAgICAgICBvcmlnaW5YOiAiY2VudGVyIiwKICAgICAgICBvcmlnaW5ZOiAiYm90dG9tIiwKICAgICAgICB0ZXh0QWxpZ246ICJjZW50ZXIiLAogICAgICAgIGZvbnRGYW1pbHk6ICJTZWdvZSBVSSIsCiAgICAgICAgdG9wOiBvbGRUb3AsCiAgICAgICAgbGVmdDogc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5kaW1lbnNpb25zLndpZHRoIC8gMiwKICAgICAgICAvLyBsZWZ0OiB3aW5kb3cuaW5uZXJXaWR0aCAvIDIsCiAgICAgICAgZm9udFNpemU6IDI0LAogICAgICAgIGZpbGw6ICIjRjUzQjU3IiwKICAgICAgICBsb2NrVW5pU2NhbGluZzogdHJ1ZQogICAgICB9KTsKICAgICAgc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleC5hZGQodGV4dEJveCkuc2V0QWN0aXZlT2JqZWN0KHRleHRCb3gpOwoKICAgICAgLy8gRW50ZXIgZWRpdGluZyBtb2RlIGltbWVkaWF0ZWx5CiAgICAgIHRleHRCb3guZW50ZXJFZGl0aW5nKCk7CiAgICAgIGNvbW1pdCgndG9nZ2xlT3ZlcmxheVNjcmVlbicsICdhZGQnKTsKCiAgICAgIC8vIExpc3RlbiB0byB0ZXh0Ym94IGV2ZW50cwogICAgICB0ZXh0Qm94Lm9uKCJlZGl0aW5nOmVudGVyZWQiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29tbWl0KCd0b2dnbGVPdmVybGF5U2NyZWVuJywgJ2FkZCcpOwogICAgICAgIG9sZFRvcCA9IHRoaXMudG9wOwogICAgICAgIG9sZExlZnQgPSB0aGlzLmxlZnQ7CiAgICAgICAgdGhpcy50b3AgPSBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmRpbWVuc2lvbnMuaGVpZ2h0IC8gMjsKICAgICAgICB0aGlzLmxlZnQgPSBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmRpbWVuc2lvbnMud2lkdGggLyAyOwogICAgICAgIC8vIHRoaXMubGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoIC8gMjsKICAgICAgfSkub24oImVkaXRpbmc6ZXhpdGVkIiwgZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMudG9wID0gb2xkVG9wOwogICAgICAgIHRoaXMubGVmdCA9IG9sZExlZnQ7CiAgICAgICAgY29tbWl0KCd0b2dnbGVPdmVybGF5U2NyZWVuJywgJ3JlbW92ZScpOwogICAgICB9KTsKICAgIH0sCiAgICBiZWdpbkRyYXdpbmdNb2RlKHsKICAgICAgc3RhdGUsCiAgICAgIGNvbW1pdAogICAgfSkgewogICAgICBjb21taXQoJ3RvZ2dsZURyYXdpbmdNb2RlU3RhdGVzJyk7CiAgICAgIGNvbW1pdCgndG9nZ2xlRHJhd2luZ01vZGUnKTsKCiAgICAgIC8vIFNldCBjYW52YXMgZHJhd2luZyBtb2RlIHRydWUKICAgICAgc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleC5pc0RyYXdpbmdNb2RlID0gdHJ1ZTsKICAgICAgc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleC5vbignbW91c2U6ZG93bjpiZWZvcmUnLCBmdW5jdGlvbiAoZSkgewogICAgICAgIGlmIChzdGF0ZS5ub3dEcmF3aW5nLmRyYXdpbmcpIHsKICAgICAgICAgIHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uaW5kZXguZnJlZURyYXdpbmdCcnVzaC5jb2xvciA9ICdyZ2JhKDI0NSwgNTksIDg3LCAxKSc7CiAgICAgICAgICBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4LmZyZWVEcmF3aW5nQnJ1c2gud2lkdGggPSAyOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZXhpdERyYXdpbmdNb2RlKHsKICAgICAgc3RhdGUsCiAgICAgIGNvbW1pdAogICAgfSkgewogICAgICBjb21taXQoJ3RvZ2dsZURyYXdpbmdNb2RlJyk7CiAgICAgIGNvbW1pdCgndG9nZ2xlRHJhd2luZ01vZGVTdGF0ZXMnKTsKICAgICAgc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5pbmRleC5pc0RyYXdpbmdNb2RlID0gZmFsc2U7CiAgICB9LAogICAgcmVtb3ZlU2VsZWN0ZWRPYmplY3QoewogICAgICBzdGF0ZQogICAgfSkgewogICAgICBzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4LnJlbW92ZShzdGF0ZS5ub3dNYXJraW5nLmNhbnZhcy5tYWluLmluZGV4LmdldEFjdGl2ZU9iamVjdCgpKTsKICAgIH0sCiAgICBkb25lRWRpdFNuYXBwZWRBbnN3ZXIoewogICAgICBzdGF0ZSwKICAgICAgY29tbWl0CiAgICB9KSB7CiAgICAgIC8vIExvYWQgbWFya2luZyBjYW52YXMgb24gc25hcHBlZCBhbnN3ZXIgY2FudmFzCiAgICAgIGxldCBtYXJraW5ncyA9IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uaW5kZXgudG9KU09OKCk7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgc3RhdGUubWFya2luZ1tzdGF0ZS5ub3dNYXJraW5nLmltYWdlLmluZGV4XSA9IHN0YXRlLm5vd01hcmtpbmcuY2FudmFzLm1haW4uaW5kZXgudG9EYXRhVVJMKCk7CiAgICAgICAgY29tbWl0KCdzZXRQcmV2aWV3aW5nTW9kZScpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9LAogICAgYWRkTWFyayh7CiAgICAgIHN0YXRlLAogICAgICBjb21taXQKICAgIH0sIG1hcmtzKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgc3RhdGUuc3VibWlzc2lvbi5tYXJrcyA9IG1hcmtzOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9LAogICAgYWRkRmVlZGJhY2soewogICAgICBzdGF0ZSwKICAgICAgY29tbWl0CiAgICB9LCBmZWVkYmFjaykgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgIHN0YXRlLnN1Ym1pc3Npb24uZmVlZGJhY2sgPSBmZWVkYmFjazsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pOwogICAgfSwKICAgIHVuZG9FZGl0ZWRTbmFwcGVkQW5zd2VyKHsKICAgICAgc3RhdGUsCiAgICAgIGNvbW1pdCwKICAgICAgZGlzcGF0Y2gKICAgIH0pIHsKICAgICAgbGV0IGluZGV4ID0gc3RhdGUubm93TWFya2luZy5pbWFnZS5pbmRleDsKICAgICAgc3RhdGUubm93TWFya2luZy5pbWFnZS5wYXRoID0gc3RhdGUuYXNzaWdubWVudERldGFpbHMuc25hcHBlZEFuc3dlclBhdGhzW2luZGV4XTsKICAgICAgY29tbWl0KCdkaXNwb3NlQ2FudmFzJyk7CiAgICAgIGRpc3BhdGNoKCdpbml0aWFsaXNlTWFya2luZ0NhbnZhcycpOwogICAgfSwKICAgIHN1Ym1pdCh7CiAgICAgIHN0YXRlLAogICAgICBjb21taXQsCiAgICAgIGRpc3BhdGNoCiAgICB9KSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgaWYgKHN0YXRlLnN1Ym1pc3Npb24ubWFya3MgPT09IG51bGwgfHwgc3RhdGUuc3VibWlzc2lvbi5tYXJrcyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBjb21taXQoJ3RvZ2dsZU1vZGFsTW9kZScsICdlcnJvcl9taXNzaW5nX21hcmsnKTsKICAgICAgICAgIHJlamVjdCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoIXN0YXRlLnN0YXRlcy5pc1N1Ym1pdHRpbmcpIHsKICAgICAgICAgICAgY29tbWl0KCd0b2dnbGVNb2RhbE1vZGUnLCAnaXNfY2hlY2tpbmcnKTsKICAgICAgICAgICAgZGlzcGF0Y2goJ2NoZWNrQWxsQ29udmVydGVkVG9EYXRhVVJMJykKCiAgICAgICAgICAgIC8vIElmIGFsbCBpbWFnZSB0eXBlcyBhcmUgZGF0YVVSTAogICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgICAgY29tbWl0KCd0b2dnbGVNb2RhbE1vZGUnKTsKICAgICAgICAgICAgICBjb21taXQoJ3RvZ2dsZU1vZGFsTW9kZScsICdpc19zdWJtaXR0aW5nJyk7CiAgICAgICAgICAgICAgTWFya3NSZXBvc2l0b3J5LnN0b3JlKHsKICAgICAgICAgICAgICAgIGFzc2lnbm1lbnRJRDogc3RhdGUuYXNzaWdubWVudERldGFpbHMuYXNzaWdubWVudElELAogICAgICAgICAgICAgICAgc3R1ZGVudElEOiBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5zdHVkZW50SUQsCiAgICAgICAgICAgICAgICBhbnN3ZXJJRDogc3RhdGUuYXNzaWdubWVudERldGFpbHMuc3VibWlzc2lvbklELAogICAgICAgICAgICAgICAgc3VibWlzc2lvblR5cGU6IHN0YXRlLnN1Ym1pc3Npb24udHlwZSwKICAgICAgICAgICAgICAgIHNuYXBwZWRBbnN3ZXJzOiBzdGF0ZS5tYXJraW5nLAogICAgICAgICAgICAgICAgbWFya3M6IHN0YXRlLnN1Ym1pc3Npb24ubWFya3MsCiAgICAgICAgICAgICAgICBmZWVkYmFjazogc3RhdGUuc3VibWlzc2lvbi5mZWVkYmFjawogICAgICAgICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICBjb21taXQoJ3NldE1haW5Nb2RlJyk7CiAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3RhdGUuYXNzaWdubWVudERldGFpbHMuc3VibWlzc2lvbklEKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGNvbW1pdCgndG9nZ2xlTW9kYWxNb2RlJyk7CiAgICAgICAgICAgICAgICAgIGNvbW1pdCgndG9nZ2xlTW9kYWxNb2RlJywgJ2Vycm9yX3N1Ym1pdF9tYXJraW5ncycpOwogICAgICAgICAgICAgICAgICBzdGF0ZS5zdGF0ZXMuZXJyb3JNZXNzYWdlcyA9IHJlc3BvbnNlLmRhdGEuZGF0YS5lcnJvcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICAgICAgICBjb21taXQoJ3RvZ2dsZU1vZGFsTW9kZScpOwogICAgICAgICAgICAgICAgY29tbWl0KCd0b2dnbGVNb2RhbE1vZGUnLCAnZXJyb3Jfc3VibWl0X21hcmtpbmdzJyk7CiAgICAgICAgICAgICAgICBzdGF0ZS5zdGF0ZXMuZXJyb3JNZXNzYWdlcyA9IGVycm9yOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KQoKICAgICAgICAgICAgLy8gSWYgc29tZSBpbWFnZXMgYXJlIG5vdCBjb252ZXJ0ZWQgdG8gZGF0YVVSTCB5ZXQKICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGNvbW1pdCgndG9nZ2xlTW9kYWxNb2RlJyk7CiAgICAgICAgICAgICAgICBjb21taXQoJ3RvZ2dsZU1vZGFsTW9kZScsICdlcnJvcl9pbnZhbGlkX2ltYWdlX3R5cGUnKTsKICAgICAgICAgICAgICB9LCAxNTAwKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zb2xlLmxvZygnQWxyZWFkeSBzdWJtaXR0aW5nIGEgbWFya2luZy4nKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgZ2V0dGVyczogewogICAgaW1hZ2VzOiAoc3RhdGUsIGdldHRlcnMpID0+IHsKICAgICAgaWYgKGdldHRlcnMuaGFzTWFya2VkU25hcHBlZEFuc3dlcikgewogICAgICAgIHJldHVybiBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5tYXJrZWRTbmFwcGVkQW5zd2VyUGF0aHM7CiAgICAgIH0gZWxzZSBpZiAoZ2V0dGVycy5oYXNTbmFwcGVkQW5zd2VyKSB7CiAgICAgICAgcmV0dXJuIHN0YXRlLm1hcmtpbmc7CiAgICAgIH0KICAgIH0sCiAgICBtYXJraW5nU3RpY2tlcnM6IChzdGF0ZSwgZ2V0dGVycykgPT4gewogICAgICBsZXQgcmVzdWx0ID0gW1sndGljay1zdGlja2VyJywgJ2ZhbHNlLXN0aWNrZXInLCAncXVlc3Rpb24tbWFyay1zdGlja2VyJ10sIFsnY29uZnVzZWQtcGVyc29uLXN0aWNrZXInLCAnbGV0cy1nby1zdGlja2VyJywgJ3RvcC1zdGlja2VyJ11dOwogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIGlzQW5zd2VyZWQ6IHN0YXRlID0+IHsKICAgICAgcmV0dXJuIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLmFuc3dlcl90YWcgIT09ICd1bmFuc3dlcmVkJzsKICAgIH0sCiAgICBhbnN3ZXJUYWdzOiBzdGF0ZSA9PiB7CiAgICAgIGxldCB0YWcgPSBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5hbnN3ZXJfdGFnOwogICAgICBpZiAodGFnID09PSAndW5hbnN3ZXJlZCcpIHsKICAgICAgICByZXR1cm4gdGFnOwogICAgICB9CiAgICB9LAogICAgaGFzV3JpdHRlbkFuc3dlcjogKHN0YXRlLCBnZXR0ZXJzKSA9PiB7CiAgICAgIHJldHVybiBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy53cml0dGVuQW5zd2VyICE9PSBudWxsICYmIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLndyaXR0ZW5BbnN3ZXIgIT09IHVuZGVmaW5lZDsKICAgIH0sCiAgICBoYXNTbmFwcGVkQW5zd2VyOiAoc3RhdGUsIGdldHRlcnMpID0+IHsKICAgICAgcmV0dXJuIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLnNuYXBwZWRBbnN3ZXJQYXRocyAhPT0gbnVsbCAmJiBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5zbmFwcGVkQW5zd2VyUGF0aHMgIT09IHVuZGVmaW5lZDsKICAgIH0sCiAgICBoYXNNYXJrZWRTbmFwcGVkQW5zd2VyOiAoc3RhdGUsIGdldHRlcnMpID0+IHsKICAgICAgcmV0dXJuIHN0YXRlLmFzc2lnbm1lbnREZXRhaWxzLm1hcmtlZFNuYXBwZWRBbnN3ZXJQYXRocyAhPT0gbnVsbCAmJiBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5tYXJrZWRTbmFwcGVkQW5zd2VyUGF0aHMgIT09IHVuZGVmaW5lZDsKICAgIH0sCiAgICBpc01hcmtlZEFzc2lnbm1lbnQ6IChzdGF0ZSwgZ2V0dGVycykgPT4gewogICAgICByZXR1cm4gc3RhdGUuYXNzaWdubWVudERldGFpbHMubWFya3NJRCAhPT0gbnVsbCAmJiBzdGF0ZS5hc3NpZ25tZW50RGV0YWlscy5tYXJrc0lEICE9PSB1bmRlZmluZWQ7CiAgICB9LAogICAgbWFya2luZ1BhdGhFeGlzdHMoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLm5vd01hcmtpbmcuaW1hZ2UucGF0aCAhPT0gbnVsbDsKICAgIH0sCiAgICBiYWNrZ3JvdW5kSW1hZ2VTY2FsZUZhY3RvcihzdGF0ZSkgewogICAgICByZXR1cm4gc3RhdGUubm93TWFya2luZy5jYW52YXMubWFpbi5kaW1lbnNpb25zLndpZHRoIC8gc3RhdGUubm93TWFya2luZy5pbWFnZS5kaW1lbnNpb25zLndpZHRoOwogICAgfSwKICAgIGlzTWFpblBhZ2Uoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnN0YXRlcy5pc01haW4gPT09IHRydWUgJiYgc3RhdGUuc3RhdGVzLmlzUHJldmlld2luZyA9PT0gZmFsc2UgJiYgc3RhdGUuc3RhdGVzLmlzTWFya2luZyA9PT0gZmFsc2U7CiAgICB9LAogICAgaXNQcmV2aWV3aW5nKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS5zdGF0ZXMuaXNNYWluID09PSBmYWxzZSAmJiBzdGF0ZS5zdGF0ZXMuaXNQcmV2aWV3aW5nID09PSB0cnVlICYmIHN0YXRlLnN0YXRlcy5pc01hcmtpbmcgPT09IGZhbHNlOwogICAgfSwKICAgIGlzUHJlcGFyaW5nQ2FudmFzKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS5zdGF0ZXMuaXNQcmV2aWV3aW5nID09PSB0cnVlICYmIHN0YXRlLnN0YXRlcy5pc1ByZXBhcmluZ0NhbnZhcyA9PT0gdHJ1ZTsKICAgIH0KICB9Cn07"},{"version":3,"names":["SubmissionRepository","get","router","fabric","stickers","MarksRepository","getters","getDefaultState","states","isLoading","isMain","isPreviewing","isPreparingCanvas","isMarking","isSelectingSticker","isSelectingObject","isZoomingCanvas","isPanningCanvas","isMovingObject","isModifyingObject","isDrawing","isWritingFeedback","isCheckingSubmission","isSubmitting","isShowingModal","isSavingEditedSnappedAnswer","assignmentDetails","submissionID","studentID","studentName","assignmentID","assignmentTitle","snappedAnswerPaths","writtenAnswer","createdAt","updatedAt","submittedTime","submittedDate","marksID","marks","markedSnappedAnswerPaths","answer_tag","nowMarking","image","index","path","dimensions","height","width","selectedObject","sticker","textBox","canvas","main","markings","trashObject","overlayScreen","isOverlaid","nowDrawing","drawing","erasing","nowShowingModal","stickerCollection","marking","submission","type","snappedAnswers","feedback","errorMessages","namespaced","state","mutations","setAssignmentDetails","data","submission_id","student_id","student_name","assignment_id","assignment_title","written_answer","created_at","updated_at","submission_time","submission_date","marks_id","isFirstSubmission","is_first","snap_answer","snap_answer_url","split","marking_picture_url","loadCanvas","Canvas","disposeCanvas","dispose","togglePreviewMode","setMainMode","setWritingFeedbackMode","exitWritingFeedbackMode","toggleStickerBar","toggleEditingTextboxMode","toggleDrawingMode","toggleDrawingModeStates","toggleModalMode","setMarkingMode","setPreviewingMode","toggleSelectingObjectMode","getActiveObject","togglePreparingCanvasMode","isScalingObject","toggleMovingObjectMode","toggleCanvasZoomingMode","toggleScalingObjectMode","toggleOverlayScreen","action","add","renderAll","sendBackwards","Rect","left","top","fill","selectable","remove","resetObjectSelection","discardActiveObject","setInitialCanvasDimensions","containerWidth","containerHeight","canvasWidth","resetState","Object","assign","actions","fetchData","commit","Promise","resolve","reject","find","then","response","success","bulkConvertSubmissionsToDataURL","toConvert","length","forEach","imagePath","isConverted","convertToDataURL","decodeURIComponent","console","log","catch","error","checkAllConvertedToDataURL","toCheck","enterMarkingMode","isMarkedAssignment","initialiseMarkingCanvas","dispatch","rootGetters","scaleFactor","imageIsLongerThanScreenHeight","window","innerHeight","setBackgroundImage","bind","originX","originY","scaleX","scaleY","crossOrigin","getSnappedAnswerDimensions","Image","fromURL","img","enableCanvasZoom","on","mouse:wheel","opt","delta","e","deltaY","zoom","getZoom","zoomToPoint","x","offsetX","y","offsetY","preventDefault","stopPropagation","vpt","viewportTransform","getWidth","getHeight","touch:gesture","touches","self","scale","point","Point","enableDragAndDropToTrash","enableCanvasPanning","mouse:down","event","altKey","isDragging","selection","lastPosX","clientX","lastPosY","clientY","mouse:move","requestRenderAll","mouse:up","setViewportTransform","touch:drag","initialX","JSON","parse","stringify","start","initialY","lastX","lastY","deltaX","relativePan","dragCount","handleObjectModification","object:scaling","target","object:scaled","object:rotating","object:rotated","object:moving","object:moved","selection:created","selection:updated","selection:cleared","loadSticker","stickerName","loadSVGFromString","objects","options","obj","util","groupSVGElements","scaleToHeight","set","setCoords","loadTextBox","oldTop","oldLeft","Textbox","textAlign","fontFamily","fontSize","lockUniScaling","setActiveObject","enterEditing","beginDrawingMode","isDrawingMode","freeDrawingBrush","color","exitDrawingMode","removeSelectedObject","doneEditSnappedAnswer","toJSON","toDataURL","addMark","addFeedback","undoEditedSnappedAnswer","submit","undefined","store","answerID","submissionType","setTimeout","images","hasMarkedSnappedAnswer","hasSnappedAnswer","markingStickers","result","isAnswered","answerTags","tag","hasWrittenAnswer","markingPathExists","backgroundImageScaleFactor","isMainPage"],"sources":["/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/src/store/modules/teacherMarking.js"],"sourcesContent":["import SubmissionRepository from \"@/repositories/SubmissionRepository\";\nimport {get} from \"v-calendar/src/utils/_\";\nimport router from \"@/router\";\nimport {fabric} from \"fabric\";\nimport stickers from \"@/components/Stickers/Stickers\";\nimport MarksRepository from \"@/repositories/teachers/MarksRepository\";\nimport 'fabric-history';\nimport getters from \"@/store/getters\";\n\nconst getDefaultState = () => {\n    return {\n        states: {\n            isLoading: true,\n            isMain: true,\n            isPreviewing: false,\n            isPreparingCanvas: false,\n            isMarking: false,\n            isSelectingSticker: false,\n            isSelectingObject: false,\n            isZoomingCanvas: false,\n            isPanningCanvas: false,\n            isMovingObject: false,\n            isModifyingObject: false,\n            isDrawing: false,\n            isWritingFeedback: false,\n            isCheckingSubmission: false,\n            isSubmitting: false,\n            isShowingModal: false,\n            isSavingEditedSnappedAnswer: false\n        },\n\n        // Assignment Details\n        assignmentDetails: {\n            submissionID: null,\n            studentID: null,\n            studentName: null,\n            assignmentID: null,\n            assignmentTitle: null,\n            snappedAnswerPaths: null,\n            writtenAnswer: null,\n            createdAt: null,\n            updatedAt: null,\n            submittedTime: null,\n            submittedDate: null,\n            marksID: null,\n            marks: null,\n            markedSnappedAnswerPaths: null,\n            answer_tag: null\n        },\n\n        // Image being marked (temporary)\n        nowMarking: {\n            image: {\n                index: null,\n                path: null,\n                dimensions: {\n                    height: null,\n                    width: null\n                }\n            },\n            selectedObject: null,\n            sticker: null,\n            textBox: false,\n            canvas: {\n                main: {\n                    index: null,\n                    dimensions: {\n                        height: null,\n                        width: null\n                    }\n                },\n                markings: {\n                    index: null,\n                    dimensions: {\n                        height: null,\n                        width: null\n                    }\n                }\n            },\n            trashObject: null,\n            overlayScreen: null, // overlay screen object\n            isOverlaid: false, // is canvas overlaid\n        },\n\n        // Drawing Mode states\n        nowDrawing: {\n            drawing: true,\n            erasing: false\n        },\n\n        // Modal being displayed\n        nowShowingModal: null,\n\n        // Available stickers\n        stickerCollection: [\n            'tick-sticker',\n            'confused-person-sticker',\n            'top-sticker',\n            'lets-go-sticker',\n            'false-sticker',\n            'question-mark-sticker'\n        ],\n\n        // Marked images\n        marking: [],\n\n\n        submission: {\n            type: '',\n            snappedAnswers: [],\n            feedback: '',\n            marks: null\n        },\n        errorMessages: null\n    }\n}\n\nexport default {\n    namespaced: true,\n    state: () => getDefaultState(),\n    mutations: {\n\n        setAssignmentDetails(state, data) {\n\n            state.assignmentDetails.submissionID = data.submission_id;\n            state.assignmentDetails.studentID = data.student_id;\n            state.assignmentDetails.studentName = data.student_name;\n            state.assignmentDetails.assignmentID = data.assignment_id;\n            state.assignmentDetails.assignmentTitle = data.assignment_title;\n            state.assignmentDetails.writtenAnswer = data.written_answer;\n            state.assignmentDetails.createdAt = data.created_at;\n            state.assignmentDetails.updatedAt = data.updated_at;\n            state.assignmentDetails.submittedTime = data.submission_time;\n            state.assignmentDetails.submittedDate = data.submission_date;\n            state.assignmentDetails.marksID = data.marks_id;\n            state.assignmentDetails.marks = data.marks;\n            state.assignmentDetails.isFirstSubmission = data.is_first;\n            state.assignmentDetails.answer_tag = data.answer_tag;\n\n            if (data.snap_answer) {\n                state.submission.type = 'snapped';\n                state.assignmentDetails.snappedAnswerPaths = state.marking = data.snap_answer_url.split(',');\n            }\n\n            if (data.written_answer) {\n                state.submission.type = 'written';\n            }\n\n            if (data.marking_picture_url) {\n                state.assignmentDetails.markedSnappedAnswerPaths = data.marking_picture_url.split(',');\n            }\n        },\n\n\n        loadCanvas(state) {\n\n            // Initialise canvas with placeholder dimensions. To be resized once loaded image\n            state.nowMarking.canvas.main.index = new fabric.Canvas('canvas', {\n                width: state.nowMarking.canvas.main.dimensions.width,\n                height: state.nowMarking.canvas.main.dimensions.height,\n            })\n        },\n\n        disposeCanvas(state) {\n            state.nowMarking.canvas.main.index.dispose();\n        },\n\n        togglePreviewMode(state) {\n\n            state.states = {\n                isLoading: false,\n                isMain: !state.states.isMain,\n                isPreviewing: !state.states.isPreviewing,\n                isPreparingCanvas: false,\n                isMarking: false,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            }\n        },\n\n        setMainMode(state) {\n            state.states = {\n                isLoading: false,\n                isMain: true,\n                isPreviewing: false,\n                isPreparingCanvas: false,\n                isMarking: false,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            }\n        },\n\n        setWritingFeedbackMode(state) {\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isPreparingCanvas: false,\n                isMarking: false,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: true,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            }\n        },\n\n        exitWritingFeedbackMode(state) {\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: true,\n                isPreparingCanvas: false,\n                isMarking: false,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            }\n        },\n\n        toggleStickerBar(state) {\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isPreparingCanvas: false,\n                isMarking: true,\n                isSelectingSticker: !state.states.isSelectingSticker,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n        },\n\n        toggleEditingTextboxMode(state) {\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isPreparingCanvas: false,\n                isMarking: true,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: !state.states.isDrawing,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n\n        },\n        toggleDrawingMode(state) {\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isPreparingCanvas: false,\n                isMarking: true,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: !state.states.isDrawing,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n\n        },\n\n        toggleDrawingModeStates(state) {\n            // If isDrawing, then initialise drawing mode states\n            if (state.states.isDrawing) {\n                state.nowDrawing.drawing = !state.nowDrawing.drawing;\n                state.nowDrawing.erasing = !state.nowDrawing.erasing;\n            } else {\n                state.nowDrawing.drawing = true;\n                state.nowDrawing.erasing = false;\n            }\n        },\n\n        toggleModalMode(state, type) {\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: true,\n                isPreparingCanvas: false,\n                isMarking: false,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: !state.states.isMovingObject,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: !state.states.isShowingModal,\n                isSavingEditedSnappedAnswer: false\n            };\n\n            state.nowShowingModal = type;\n        },\n\n        setMarkingMode(state) {\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isPreparingCanvas: false,\n                isMarking: true,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n\n        },\n        setPreviewingMode(state) {\n\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: true,\n                isPreparingCanvas: false,\n                isMarking: false,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n        },\n\n        toggleSelectingObjectMode(state) {\n\n            let isSelectingObject = state.nowMarking.canvas.main.index.getActiveObject();\n\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isMarking: true,\n                isSelectingSticker: false,\n                isSelectingObject: isSelectingObject,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n        },\n\n        togglePreparingCanvasMode(state) {\n\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: true,\n                isPreparingCanvas: !state.states.isPreparingCanvas,\n                isMarking: false,\n                isSelectingSticker: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isScalingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n        },\n\n        toggleMovingObjectMode(state) {\n\n            let isSelectingObject = state.nowMarking.canvas.main.index.getActiveObject();\n\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isPreparingCanvas: false,\n                isMarking: true,\n                isSelectingSticker: false,\n                isSelectingObject: state.states.isMovingObject ? isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: !state.states.isMovingObject,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n        },\n\n        toggleCanvasZoomingMode(state) {\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isMarking: true,\n                isSelectingSticker: false,\n                isSelectingObject: false,\n                isZoomingCanvas: !state.states.isZoomingCanvas,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: false,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n        },\n\n        toggleScalingObjectMode(state) {\n\n            let isSelectingObject = state.nowMarking.canvas.main.index.getActiveObject();\n\n            state.states = {\n                isLoading: false,\n                isMain: false,\n                isPreviewing: false,\n                isPreparingCanvas: false,\n                isMarking: true,\n                isSelectingSticker: false,\n                isSelectingObject: state.states.isModifyingObject ? isSelectingObject: false,\n                isZoomingCanvas: false,\n                isPanningCanvas: false,\n                isDrawing: false,\n                isMovingObject: false,\n                isModifyingObject: !state.states.isModifyingObject,\n                isWritingFeedback: false,\n                isCheckingSubmission: false,\n                isSubmitting: false,\n                isShowingModal: false,\n                isSavingEditedSnappedAnswer: false\n            };\n        },\n\n        // Available actions: add, remove\n        toggleOverlayScreen(state, action) {\n\n            if (action === 'add' && !state.nowMarking.isOverlaid) {\n                if (state.nowMarking.overlayScreen) {\n                    state.nowMarking.canvas.main.index.add(state.nowMarking.overlayScreen).renderAll()\n                    state.nowMarking.overlayScreen.sendBackwards()\n                } else {\n                    state.nowMarking.overlayScreen = new fabric.Rect({\n                        left: 0,\n                        top: 0,\n                        fill: 'rgba(0,0,0, 0.5)',\n                        width: state.nowMarking.canvas.main.dimensions.width,\n                        height: state.nowMarking.canvas.main.dimensions.height,\n                        selectable: false\n                    })\n\n                    state.nowMarking.canvas.main.index.add(state.nowMarking.overlayScreen).renderAll()\n                    state.nowMarking.overlayScreen.sendBackwards()\n\n                }\n\n                state.nowMarking.isOverlaid = true;\n\n            } else if (action === 'remove') {\n                if (state.nowMarking.overlayScreen) {\n                    state.nowMarking.canvas.main.index.remove(state.nowMarking.overlayScreen)\n                    state.nowMarking.isOverlaid = false;\n\n                }\n            }\n\n        },\n\n        resetObjectSelection(state) {\n            state.nowMarking.canvas.main.index.discardActiveObject().renderAll()\n        },\n\n        setInitialCanvasDimensions(state, containerWidth, containerHeight) {\n\n            // Determine canvas dimensions\n            let canvasWidth = 0.9 * containerWidth;\n            // let canvasWidth = 0.9 * window.innerWidth;\n            // if (window.innerWidth > 700) {\n            //     if (window.innerWidth > 1000) {\n            //         canvasWidth = 0.9 * containerWidth;\n                    // canvasWidth = 0.5 * window.innerWidth;\n                // } else {\n                //     canvasWidth = 0.9 * containerWidth;\n                    // canvasWidth = 0.65 * window.innerWidth;\n            //     }\n            // }\n\n            state.nowMarking.canvas.main.dimensions = {\n                height: containerHeight,\n                width: canvasWidth\n                // height: 0.75 * window.innerHeight,\n                // width: 0.9 * window.innerWidth\n            }\n\n        },\n\n        resetState(state) {\n            Object.assign(state, getDefaultState())\n        }\n\n\n    },\n    actions: {\n\n        // FETCH: Submission Details\n        fetchData({state, commit}, submissionID) {\n\n            return new Promise((resolve, reject) => {\n                SubmissionRepository.find(submissionID)\n                    .then(response => {\n                        if (response.data.success) {\n                            commit('setAssignmentDetails', response.data.data)\n                            state.states.isLoading = false;\n                            resolve();\n                        } else {\n                            reject();\n                        }\n                    });\n            });\n        },\n\n        /************************\n         Convert snapped answers to dataURL asynchronously\n         *************************/\n        bulkConvertSubmissionsToDataURL({state, getters, commit}) {\n\n            let toConvert = state.marking.length;\n\n            return new Promise((resolve, reject) => {\n\n                state.marking.forEach((imagePath, index) => {\n\n                    // Check if image is already converted to dataURL\n                    let isConverted = imagePath.split(\",\")[0] === 'data:image/jpg;base64' || imagePath.split(\",\")[0] === 'data:image/jpeg;base64' || imagePath.split(\",\")[0] === 'data:image/png;base64';\n\n                    // If not yet, convert now\n                    if (!isConverted) {\n\n                        SubmissionRepository.convertToDataURL(imagePath)\n                            .then(response => {\n                                if (response.data.success) {\n                                    state.marking[index] = decodeURIComponent(response.data.data);\n                                    toConvert--;\n                                } else {\n                                    console.log('Failed to convert image to dataURL')\n                                }\n                            })\n                            .catch(error => {\n                                console.log('Failed to convert image to dataURL')\n                            })\n                    } else {\n                        toConvert--;\n                    }\n\n                });\n\n\n            });\n        },\n\n        checkAllConvertedToDataURL({state}) {\n            return new Promise((resolve, reject) => {\n\n                let toCheck = state.marking.length;\n\n                state.marking.forEach((imagePath, index) => {\n                    let isConverted = imagePath.split(\",\")[0] === 'data:image/jpg;base64' || imagePath.split(\",\")[0] === 'data:image/png;base64';\n\n                    if (isConverted) {\n                        toCheck--;\n\n                        if (toCheck === 0) {\n                            resolve();\n                        }\n\n                    } else {\n                        reject('Please try again')\n                    }\n                });\n            });\n        },\n\n\n        enterMarkingMode({state, getters, commit}, nowMarking) {\n\n            return new Promise((resolve, reject) => {\n\n                if (state.states.isPreviewing && !getters.isMarkedAssignment) {\n\n                    // Check if image is already converted to dataURL\n                    let isConverted = nowMarking.path.split(\",\")[0] === 'data:image/jpg;base64';\n\n                    if (isConverted) {\n                        state.nowMarking.image.index = nowMarking.index;\n                        state.nowMarking.image.path = nowMarking.path;\n                        resolve()\n                    } else {\n                        SubmissionRepository.convertToDataURL(nowMarking.path)\n                            .then(response => {\n\n                                if (response.data.success) {\n                                    state.nowMarking.image.index = nowMarking.index;\n                                    state.nowMarking.image.path = decodeURIComponent(response.data.data);\n\n                                    resolve()\n                                } else {\n                                    reject()\n                                }\n                            })\n                            .catch(error => {\n                                reject()\n                            })\n                    }\n\n\n                } else {\n                    reject()\n                }\n            })\n        },\n\n        /***********\n         SEQUENCE:\n         1) Get image size\n         2) Create new canvas\n         3) Set canvas background image\n         4) Enable actions\n         * */\n        initialiseMarkingCanvas({state, commit, dispatch, rootGetters}) {\n\n            dispatch('getSnappedAnswerDimensions').then(() => {\n\n                let scaleFactor = state.nowMarking.canvas.main.dimensions.width / state.nowMarking.image.dimensions.width;\n\n                // Determine if image is longer than screen height\n                let imageIsLongerThanScreenHeight = (scaleFactor * state.nowMarking.image.dimensions.height) > 0.7 * window.innerHeight\n\n                // Set canvas size\n                state.nowMarking.canvas.main.index = new fabric.Canvas('canvas_snapped_answer', {\n                    width: scaleFactor * state.nowMarking.image.dimensions.width,\n                    height: imageIsLongerThanScreenHeight ? scaleFactor * state.nowMarking.image.dimensions.height : scaleFactor * state.nowMarking.image.dimensions.height + 0.3 * window.innerHeight,\n                })\n\n                // Store canvas dimension values\n                state.nowMarking.canvas.main.dimensions = {\n                    width: scaleFactor * state.nowMarking.image.dimensions.width,\n                    height: imageIsLongerThanScreenHeight ? scaleFactor * state.nowMarking.image.dimensions.height : scaleFactor * state.nowMarking.image.dimensions.height + 0.3 * window.innerHeight,\n                    // height: imageIsLongerThanScreenHeight ? scaleFactor * state.nowMarking.image.dimensions.height : 0.7 * window.innerHeight,\n                }\n\n                // Set background image of main canvas\n                state.nowMarking.canvas.main.index.setBackgroundImage(\n                    state.nowMarking.image.path,\n                    state.nowMarking.canvas.main.index.renderAll.bind(state.nowMarking.canvas.main.index),\n                    {\n                        top: imageIsLongerThanScreenHeight ? 0 : state.nowMarking.canvas.main.dimensions.height / 3,\n                        left: state.nowMarking.canvas.main.dimensions.width / 2,\n                        originX: 'center',\n                        originY: imageIsLongerThanScreenHeight ? 'top' : 'center',\n                        scaleX: state.nowMarking.canvas.main.dimensions.width / state.nowMarking.image.dimensions.width,\n                        scaleY: state.nowMarking.canvas.main.dimensions.width / state.nowMarking.image.dimensions.width\n                    },\n                    {crossOrigin: 'Anonymous'}\n                );\n\n\n                // Enable/disable marking functions\n                dispatch('enableDragAndDropToTrash')\n\n                // Currently enable only for test account\n                if (rootGetters['getAuthEmail'] === 'cikgu@snapped.com' || rootGetters['getAuthEmail'] === 'cikgumaria@snapped.com') {\n                    dispatch('enableCanvasZoom')\n                    dispatch('enableCanvasPanning')\n                }\n\n                dispatch('handleObjectModification')\n\n\n            })\n        },\n\n        getSnappedAnswerDimensions({state, commit, dispatch}) {\n            return new Promise((resolve, reject) => {\n                fabric.Image.fromURL(state.nowMarking.image.path, (img, error) => {\n                    state.nowMarking.image.dimensions.width = img.width;\n                    state.nowMarking.image.dimensions.height = img.height;\n                    resolve();\n                });\n            })\n        },\n\n        /*****************\n         * CANVAS: ZOOM\n         ****************/\n        enableCanvasZoom({state, commit, dispatch}) {\n\n            let canvas = state.nowMarking.canvas.main.index;\n\n            // Track canvas events\n            canvas.on({\n\n                // ON MOUSE WHEEL\n                'mouse:wheel': function (opt) {\n\n                    commit('toggleCanvasZoomingMode')\n\n                    if (state.states.isZoomingCanvas) {\n                        let delta = opt.e.deltaY;\n                        let zoom = canvas.getZoom();\n                        zoom *= 0.999 ** delta;\n                        if (zoom > 6) zoom = 6;\n                        if (zoom < 1) zoom = 1;\n                        canvas.zoomToPoint({x: opt.e.offsetX, y: opt.e.offsetY}, zoom);\n\n                        opt.e.preventDefault();\n                        opt.e.stopPropagation();\n\n                        let vpt = this.viewportTransform;\n\n                        if (zoom < 400 / 1000) {\n                            vpt[4] = 200 - 1000 * zoom / 2;\n                            vpt[5] = 200 - 1000 * zoom / 2;\n                        } else {\n                            if (vpt[4] >= 0) {\n                                vpt[4] = 0;\n                            } else if (vpt[4] < canvas.getWidth() - 1000 * zoom) {\n                                vpt[4] = canvas.getWidth() - 1000 * zoom;\n                            }\n                            if (vpt[5] >= 0) {\n                                vpt[5] = 0;\n                            } else if (vpt[5] < canvas.getHeight() - 1000 * zoom) {\n                                vpt[5] = canvas.getHeight() - 1000 * zoom;\n                            }\n                        }\n\n                        commit('toggleCanvasZoomingMode')\n                    }\n\n\n                },\n                'touch:gesture': function (opt) {\n\n                    // If user pinch to zoom\n                    if (opt.e.touches && opt.e.touches.length === 2 && !state.states.isModifyingObject) {\n\n                        if (state.states.isSelectingObject) {\n                            commit('resetObjectSelection')\n                        }\n\n                        commit('toggleCanvasZoomingMode')\n\n                        // dispatch('addDebugMessage', stateChange)\n\n                        if (state.states.isZoomingCanvas) {\n\n                            // dispatch('addDebugMessage', [\n                            //     `touch gesture : ${opt.e.touches.length}`,\n                            //     `is zooming: ${state.states.isZoomingCanvas}`,\n                            //     `is selecting: ${state.states.isSelectingObject}`\n                            // ])\n\n                            // dispatch('addDebugMessage', `zooming`)\n\n\n                            // Get initial canvas zoom value and initial gesture scale value\n                            let zoom = canvas.getZoom();\n                            let delta = opt.self.scale;\n\n                            if (opt.self.state === \"start\") {\n                                zoom = delta > 1 ? zoom + 1 : zoom;\n                            }\n\n                            // Slow zoom in, quicker zoom out\n                            if (delta > 1) {\n                                zoom = zoom * (1.01 ** delta);\n                            } else {\n                                zoom = zoom ** (delta);\n                            }\n\n                            // Set max zoom in and max zoom out\n                            if (zoom > 4) zoom = 4;\n                            if (zoom < 1) zoom = 1;\n\n\n                            // Determine point of scaling\n                            let point = new fabric.Point(opt.self.x, opt.self.y);\n                            if (zoom < 1) point = new fabric.Point(canvas.width / 2, canvas.height / 2);\n\n                            // // Zoom to pinch point\n                            canvas.zoomToPoint(point, zoom);\n\n                            commit('toggleCanvasZoomingMode')\n\n                        }\n\n\n                    }\n                }\n\n            });\n        },\n\n        /********************************\n         * CANVAS: DRAG & DROP TO TRASH\n         *******************************/\n        enableDragAndDropToTrash({state, commit, dispatch}) {\n\n            let canvas = state.nowMarking.canvas.main.index;\n\n            canvas.on({\n\n\n                }\n            )\n        },\n\n        /********************************\n         * CANVAS: PANNING\n         *******************************/\n        enableCanvasPanning({state, commit, dispatch}) {\n\n            let canvas = state.nowMarking.canvas.main.index;\n\n            // ON DESKTOP\n            canvas.on({\n                'mouse:down': function (opt) {\n                    let event = opt.e;\n\n\n                    if (event.altKey === true) {\n\n                        this.isDragging = true;\n                        this.selection = false;\n                        this.lastPosX = event.touches[0].clientX;\n                        this.lastPosY = event.touches[0].clientY;\n                    }\n                },\n\n                'mouse:move': function (opt) {\n                    if (this.isDragging) {\n                        let event = opt.e;\n                        let vpt = this.viewportTransform;\n                        vpt[4] += event.touches[0].clientX - this.lastPosX;\n                        vpt[5] += event.touches[0].clientY - this.lastPosY;\n                        this.requestRenderAll();\n                        this.lastPosX = event.touches[0].clientX;\n                        this.lastPosY = event.touches[0].clientY;\n                    }\n                },\n                'mouse:up': function (opt) {\n                    // on mouse up we want to recalculate new interaction\n                    // for all objects, so we call setViewportTransform\n                    this.setViewportTransform(this.viewportTransform);\n                    this.isDragging = false;\n                    this.selection = true;\n                }\n            });\n\n            // ON MOBILE\n            canvas.on({\n\n                'touch:drag': function (opt) {\n\n                    // Ensure single finger touch and not performing other actions\n                    if (opt.e.touches && opt.e.touches.length === 1 && !state.states.isMovingObject && !state.states.isModifyingObject && !state.states.isDrawing) {\n\n                        this.selection = false;\n\n                        let initialX = JSON.parse(JSON.stringify(opt.self.start.x));\n                        let initialY = JSON.parse(JSON.stringify(opt.self.start.y));\n\n                        // Get last point\n                        let lastX = opt.self.x;\n                        let lastY = opt.self.y;\n\n                        let deltaX = lastX - initialX;\n                        let deltaY = lastY - initialY;\n\n                        let delta = new fabric.Point(deltaX / 20, deltaY / 20);\n                        canvas.relativePan(delta);\n\n                        state.dragCount++;\n                    }\n\n                },\n\n            })\n        },\n\n        handleObjectModification({state, commit, dispatch}) {\n            let canvas = state.nowMarking.canvas.main.index;\n\n            canvas.on({\n                'object:scaling': function (event) {\n\n                    // If state isMovingObject not already set, set to true\n                    if (event.e.touches.length === 1 && !state.states.isModifyingObject && !state.states.isZoomingCanvas) {\n                        commit('toggleScalingObjectMode')\n                        state.nowMarking.selectedObject = event.target;\n                        commit('toggleOverlayScreen', 'add')\n                    }\n\n                    if (event.e.touches.length === 2) {\n                        commit('resetObjectSelection')\n                    }\n                },\n                'object:scaled': function (event) {\n                    commit('toggleScalingObjectMode')\n                    commit('toggleOverlayScreen', 'remove')\n                },\n                'object:rotating': function (event) {\n                    // If state isMovingObject not already set, set to true\n                    if (event.e.touches.length === 1 && !state.states.isModifyingObject && !state.states.isZoomingCanvas) {\n                        commit('toggleScalingObjectMode')\n                        state.nowMarking.selectedObject = event.target;\n                        commit('toggleOverlayScreen', 'add')\n                    }\n                },\n                'object:rotated': function (event) {\n                    commit('toggleScalingObjectMode')\n                    commit('toggleOverlayScreen', 'remove')\n                },\n                'object:moving': function (event) {\n\n                    // If state isMovingObject not already set, set to true\n                    if (!state.states.isMovingObject && event.e.touches.length === 1) {\n                        commit('toggleMovingObjectMode')\n                        state.nowMarking.selectedObject = event.target;\n\n                        commit('toggleOverlayScreen', 'add')\n\n                    }\n                },\n                'object:moved': function (event) {\n                    commit('toggleMovingObjectMode')\n                    commit('toggleOverlayScreen', 'remove')\n                },\n\n                'selection:created': function () {\n                    commit('toggleSelectingObjectMode')\n                },\n                'selection:updated': function () {\n\n                },\n                'selection:cleared': function () {\n                    commit('toggleSelectingObjectMode')\n                },\n\n            });\n        },\n\n        loadSticker({state, commit}, stickerName) {\n\n            fabric.loadSVGFromString(stickers[stickerName], (objects, options) => {\n\n                let obj = fabric.util.groupSVGElements(objects, options);\n                obj.scaleToHeight(state.nowMarking.canvas.main.dimensions.height / 12)\n                    .set({\n                        left: state.nowMarking.canvas.main.dimensions.width / 2,\n                        top: state.nowMarking.canvas.main.dimensions.height / 2\n                    })\n                    .setCoords();\n\n                state.nowMarking.canvas.main.index.add(obj).renderAll();\n            });\n\n            commit('toggleStickerBar')\n        },\n\n        loadTextBox({state, commit}) {\n\n\n            // let oldTop = state.nowMarking.canvas.main.dimensions.height / 2;\n            // let oldLeft = window.innerWidth / 2;\n\n            let oldTop = state.nowMarking.canvas.main.dimensions.width / 2;\n            let oldLeft = state.nowMarking.canvas.main.dimensions.width / 2;\n            // let oldTop = window.innerWidth / 2;\n            // let oldLeft = window.innerWidth / 2;\n\n\n            let textBox = new fabric.Textbox('', {\n                originX: \"center\",\n                originY: \"bottom\",\n                textAlign: \"center\",\n                fontFamily: \"Segoe UI\",\n                top: oldTop,\n                left: state.nowMarking.canvas.main.dimensions.width / 2,\n                // left: window.innerWidth / 2,\n                fontSize: 24,\n                fill: \"#F53B57\",\n                lockUniScaling: true\n            })\n\n            state.nowMarking.canvas.main.index.add(textBox).setActiveObject(textBox);\n\n            // Enter editing mode immediately\n            textBox.enterEditing()\n\n            commit('toggleOverlayScreen', 'add')\n\n            // Listen to textbox events\n            textBox.on(\"editing:entered\", function () {\n\n                commit('toggleOverlayScreen', 'add')\n\n                oldTop = this.top;\n                oldLeft = this.left;\n\n\n                this.top = state.nowMarking.canvas.main.dimensions.height / 2;\n                this.left = state.nowMarking.canvas.main.dimensions.width / 2;\n                // this.left = window.innerWidth / 2;\n\n            }).on(\"editing:exited\", function () {\n                this.top = oldTop;\n                this.left = oldLeft;\n\n                commit('toggleOverlayScreen', 'remove')\n\n            });\n        },\n\n        beginDrawingMode({state, commit}) {\n\n            commit('toggleDrawingModeStates')\n            commit('toggleDrawingMode')\n\n            // Set canvas drawing mode true\n            state.nowMarking.canvas.main.index.isDrawingMode = true;\n\n            state.nowMarking.canvas.main.index\n                .on('mouse:down:before', function (e) {\n                    if (state.nowDrawing.drawing) {\n                        state.nowMarking.canvas.main.index.freeDrawingBrush.color = 'rgba(245, 59, 87, 1)';\n                        state.nowMarking.canvas.main.index.freeDrawingBrush.width = 2;\n                    }\n                })\n        },\n\n        exitDrawingMode({state, commit}) {\n            commit('toggleDrawingMode')\n            commit('toggleDrawingModeStates')\n            state.nowMarking.canvas.main.index.isDrawingMode = false;\n\n        },\n\n        removeSelectedObject({state}) {\n            state.nowMarking.canvas.main.index.remove(state.nowMarking.canvas.main.index.getActiveObject());\n        },\n\n        doneEditSnappedAnswer({state, commit}) {\n\n            // Load marking canvas on snapped answer canvas\n            let markings = state.nowMarking.canvas.main.index.toJSON()\n\n            return new Promise((resolve, reject) => {\n                state.marking[state.nowMarking.image.index] = state.nowMarking.canvas.main.index.toDataURL()\n                commit('setPreviewingMode')\n                resolve()\n            })\n        },\n\n\n        addMark({state, commit}, marks) {\n            return new Promise((resolve, reject) => {\n                state.submission.marks = marks\n                resolve()\n            })\n        },\n\n        addFeedback({state, commit}, feedback) {\n            return new Promise((resolve, reject) => {\n                state.submission.feedback = feedback\n                resolve()\n            })\n        },\n\n        undoEditedSnappedAnswer({state, commit, dispatch}) {\n            let index = state.nowMarking.image.index;\n            state.nowMarking.image.path = state.assignmentDetails.snappedAnswerPaths[index]\n            commit('disposeCanvas')\n            dispatch('initialiseMarkingCanvas')\n        },\n\n\n\n        submit({state, commit, dispatch}) {\n\n            return new Promise((resolve, reject) => {\n\n                if (state.submission.marks === null || state.submission.marks === undefined) {\n                    commit('toggleModalMode', 'error_missing_mark')\n                    reject()\n                } else {\n\n                    if (!state.states.isSubmitting) {\n\n                        commit('toggleModalMode', 'is_checking')\n\n                        dispatch('checkAllConvertedToDataURL')\n\n                            // If all image types are dataURL\n                            .then(response => {\n                                commit('toggleModalMode')\n                                commit('toggleModalMode', 'is_submitting')\n\n                                MarksRepository.store(\n                                    {\n                                        assignmentID: state.assignmentDetails.assignmentID,\n                                        studentID: state.assignmentDetails.studentID,\n                                        answerID: state.assignmentDetails.submissionID,\n                                        submissionType: state.submission.type,\n                                        snappedAnswers: state.marking,\n                                        marks: state.submission.marks,\n                                        feedback: state.submission.feedback\n                                    })\n                                    .then(response => {\n                                        if (response.data.success) {\n                                            commit('setMainMode')\n                                            resolve(state.assignmentDetails.submissionID);\n                                        } else {\n                                            commit('toggleModalMode')\n                                            commit('toggleModalMode', 'error_submit_markings')\n                                            state.states.errorMessages = response.data.data.error;\n                                        }\n                                    })\n                                    .catch(error => {\n                                        commit('toggleModalMode')\n                                        commit('toggleModalMode', 'error_submit_markings')\n                                        state.states.errorMessages = error;\n                                    })\n\n\n                            })\n\n                            // If some images are not converted to dataURL yet\n                            .catch(error => {\n\n                                setTimeout(() => {\n                                    commit('toggleModalMode')\n                                    commit('toggleModalMode', 'error_invalid_image_type')\n                                }, 1500)\n                            })\n\n\n                    } else {\n                        console.log('Already submitting a marking.')\n                    }\n\n                }\n            })\n\n\n        },\n\n    },\n    getters: {\n\n        images: (state, getters) => {\n            if (getters.hasMarkedSnappedAnswer) {\n                return state.assignmentDetails.markedSnappedAnswerPaths\n            } else if (getters.hasSnappedAnswer) {\n                return state.marking\n            }\n        },\n\n        markingStickers: (state, getters) => {\n\n            let result = [\n                [\n                    'tick-sticker',\n                    'false-sticker',\n                    'question-mark-sticker'\n                ],\n                [\n                    'confused-person-sticker',\n                    'lets-go-sticker',\n                    'top-sticker'\n                ]\n            ];\n\n            return result\n        },\n\n        isAnswered: (state) => {\n            return state.assignmentDetails.answer_tag !== 'unanswered';\n        },\n\n        answerTags: (state) => {\n\n            let tag = state.assignmentDetails.answer_tag;\n\n            if (tag === 'unanswered') {\n                return tag;\n            }\n\n        },\n\n        hasWrittenAnswer: (state, getters) => {\n            return state.assignmentDetails.writtenAnswer !== null && state.assignmentDetails.writtenAnswer !== undefined;\n        },\n\n        hasSnappedAnswer: (state, getters) => {\n            return state.assignmentDetails.snappedAnswerPaths !== null && state.assignmentDetails.snappedAnswerPaths !== undefined;\n        },\n\n        hasMarkedSnappedAnswer: (state, getters) => {\n            return state.assignmentDetails.markedSnappedAnswerPaths !== null && state.assignmentDetails.markedSnappedAnswerPaths !== undefined;\n        },\n\n        isMarkedAssignment: (state, getters) => {\n            return state.assignmentDetails.marksID !== null && state.assignmentDetails.marksID !== undefined;\n        },\n\n        markingPathExists(state) {\n            return state.nowMarking.image.path !== null;\n        },\n\n        backgroundImageScaleFactor(state) {\n            return state.nowMarking.canvas.main.dimensions.width / state.nowMarking.image.dimensions.width;\n        },\n\n        isMainPage(state) {\n            return state.states.isMain === true && state.states.isPreviewing === false && state.states.isMarking === false;\n        },\n\n        isPreviewing(state) {\n            return state.states.isMain === false && state.states.isPreviewing === true && state.states.isMarking === false;\n        },\n\n        isPreparingCanvas(state) {\n            return state.states.isPreviewing === true && state.states.isPreparingCanvas === true;\n        }\n\n    }\n}\n"],"mappings":"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"}]}