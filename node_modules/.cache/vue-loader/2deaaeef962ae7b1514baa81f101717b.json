{"remainingRequest":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/src/views/integrations/googleAuthCallback.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/src/views/integrations/googleAuthCallback.vue","mtime":1679379067244},{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/babel-loader/lib/index.js","mtime":1680059914906},{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/cache-loader/dist/cjs.js","mtime":1680070113546},{"path":"/Users/erwinkarim/Websites/Snapped/snapped-mobile-master/node_modules/vue-loader/lib/index.js","mtime":1680070113705}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBHb29nbGVDbGFzc3Jvb21SZXBvc2l0b3J5IGZyb20gIkAvcmVwb3NpdG9yaWVzL0dvb2dsZUNsYXNzcm9vbVJlcG9zaXRvcnkiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJnb29nbGVBdXRoQ2FsbGJhY2siLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewoKICAgICAgLy8gU3RhdGUKICAgICAgaXNBdXRoZW50aWNhdGluZzogdHJ1ZSwKICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSwKCiAgICAgIHRpdGxlOiAnQXV0aGVudGljYXRpbmcuLi4nLAogICAgICBtZXNzYWdlOiAiUGxlYXNlIHdhaXQuIFRoYW5rIHlvdS4iLAogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZ29vZ2xlQ2xhc3Nyb29tQ2FsbGJhY2soKSB7CgogICAgICBsZXQgcGF5bG9hZCA9IHsKICAgICAgICBjb2RlOiB0aGlzLiRyb3V0ZS5xdWVyeS5jb2RlLAogICAgICAgIC8vIHRva2VuOiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFRva2VuCiAgICAgIH0KCiAgICAgIEdvb2dsZUNsYXNzcm9vbVJlcG9zaXRvcnkuaW50ZWdyYXRpb25DYWxsYmFjayhwYXlsb2FkKQogICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gewoKICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2VzcykgewoKICAgICAgICAgICAgICAvLyBHaXZlIHRpbWUgdG8gdXBkYXRlIHVzZXIgZGV0YWlscyBhdCBiYWNrZW5kCiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmlzQXV0aGVudGljYXRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICB0aGlzLnRpdGxlID0gJ1N1Y2Nlc3MhJwogICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gcmVzcG9uc2UuZGF0YS5tZXNzYWdlCgogICAgICAgICAgICAgICAgLy8gU2VuZCBwb3N0IG1lc3NhZ2UgdG8gcGFyZW50LiBUbyBnZXQgdXBkYXRlZCB1c2VyIGRldGFpbHMKICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuZXIucG9zdE1lc3NhZ2Uoe3N1Y2Nlc3M6IHRydWV9KQoKICAgICAgICAgICAgICAgIC8vIENsb3NlIHRoZSB3aW5kb3cKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICB3aW5kb3cuY2xvc2UoKTsKICAgICAgICAgICAgICAgIH0sIDE1MDApCiAgICAgICAgICAgICAgfSwgMTUwMCkKCgogICAgICAgICAgICB9IGVsc2UgewoKICAgICAgICAgICAgICB0aGlzLnRpdGxlID0gJ09vcHMhJwogICAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IHJlc3BvbnNlLmRhdGEubWVzc2FnZQoKICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIHdpbmRvdy5jbG9zZSgpOwogICAgICAgICAgICAgIH0sIDE1MDApCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CgogICAgICAgICAgICB0aGlzLmlzQXV0aGVudGljYXRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgIHRoaXMudGl0bGUgPSAnT29wcyEnCiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IGVycm9yOwogICAgICAgICAgfSk7CiAgICB9LAogIH0sCiAgbW91bnRlZCgpIHsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5oYW5kbGVNZXNzYWdlKQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ29vZ2xlQ2xhc3Nyb29tQ2FsbGJhY2soKTsKICB9Cn0K"},{"version":3,"sources":["googleAuthCallback.vue"],"names":[],"mappings":";AAYA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"googleAuthCallback.vue","sourceRoot":"src/views/integrations","sourcesContent":["<template>\n  <div class=\"mx-auto h-screen flex flex-col justify-center items-center\">\n    <div class=\"font-bold my-3 text-xl\">\n      {{ title }}\n    </div>\n    <div class=\"text-sm\">\n      {{ message }}\n    </div>\n  </div>\n</template>\n\n<script>\nimport GoogleClassroomRepository from \"@/repositories/GoogleClassroomRepository\";\n\nexport default {\n  name: \"googleAuthCallback\",\n  data() {\n    return {\n\n      // State\n      isAuthenticating: true,\n      isAuthenticated: false,\n\n      title: 'Authenticating...',\n      message: \"Please wait. Thank you.\",\n    }\n  },\n  methods: {\n    googleClassroomCallback() {\n\n      let payload = {\n        code: this.$route.query.code,\n        // token: this.$store.getters.getToken\n      }\n\n      GoogleClassroomRepository.integrationCallback(payload)\n          .then(response => {\n\n            if (response.data.success) {\n\n              // Give time to update user details at backend\n              setTimeout(() => {\n                this.isAuthenticating = false;\n\n                this.title = 'Success!'\n                this.message = response.data.message\n\n                // Send post message to parent. To get updated user details\n                window.opener.postMessage({success: true})\n\n                // Close the window\n                setTimeout(() => {\n                  window.close();\n                }, 1500)\n              }, 1500)\n\n\n            } else {\n\n              this.title = 'Oops!'\n              this.message = response.data.message\n\n              setTimeout(() => {\n                window.close();\n              }, 1500)\n            }\n          })\n          .catch((error) => {\n\n            this.isAuthenticating = false;\n\n            this.title = 'Oops!'\n            this.message = error;\n          });\n    },\n  },\n  mounted() {\n    window.addEventListener('message', this.handleMessage)\n  },\n  created() {\n    this.googleClassroomCallback();\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}